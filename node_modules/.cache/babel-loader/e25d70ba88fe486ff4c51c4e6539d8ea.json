{"ast":null,"code":"import _objectSpread from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _slicedToArray from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useHistory}from\"react-router-dom\";import MaterialTable,{MTableToolbar}from\"material-table\";import{makeStyles}from\"@material-ui/core/styles\";import{TextField,Icon,Button,MenuItem}from\"@material-ui/core\";import{Alert}from\"@material-ui/lab\";import{useSetRecoilState,useRecoilValue,useRecoilState}from\"recoil\";import{allowsPeriodState,allowsDataState,allowsDataDetlsState,allowsDataIdState,empidState,loginLevelState}from\"./data/atomdata\";import AddIcon from\"@material-ui/icons/Add\";import EditIcon from\"@material-ui/icons/Edit\";import DeleteIcon from\"@material-ui/icons/Delete\";import CheckIcon from\"@material-ui/icons/Check\";import SearchIcon from\"@material-ui/icons/Search\";import{CustomDialog}from\"../helpers/CustomDialog\";import{useDailyAllowancesContext}from\"../context/dailyallowances_context\";import DailyAllowancesAddPeriod from\"./DailyAllowancesAddPeriod\";import DailyAllowsDetlsTableStaff from\"./DailyAllowsDetlsTableStaff\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function DailyAllowancesTableStaff(){var history=useHistory();var classes=useStyles();var _useRecoilState=useRecoilState(loginLevelState),_useRecoilState2=_slicedToArray(_useRecoilState,2),loginLevel=_useRecoilState2[0],setLoginLevel=_useRecoilState2[1];var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isAddPeriodDialogOpen=_useState2[0],setIsAddPeriodDialogOpen=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),tmpallowsdata=_useState4[0],setTmpallowsdata=_useState4[1];var _useRecoilState3=useRecoilState(allowsDataState),_useRecoilState4=_slicedToArray(_useRecoilState3,2),allowsdata=_useRecoilState4[0],setAllowsdata=_useRecoilState4[1];var _useRecoilState5=useRecoilState(allowsDataDetlsState),_useRecoilState6=_slicedToArray(_useRecoilState5,2),allowsDetlsdata=_useRecoilState6[0],setAllowsDetlsdata=_useRecoilState6[1];var _useRecoilState7=useRecoilState(allowsPeriodState),_useRecoilState8=_slicedToArray(_useRecoilState7,2),allows_period=_useRecoilState8[0],setAllows_period=_useRecoilState8[1];var _useRecoilState9=useRecoilState(empidState),_useRecoilState10=_slicedToArray(_useRecoilState9,2),allows_empid=_useRecoilState10[0],setAllows_empid=_useRecoilState10[1];var _useState5=useState(allowsDataIdState),_useState6=_slicedToArray(_useState5,2),allowsdataId=_useState6[0],setAllowsdataId=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),toLoad=_useState8[0],settoLoad=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],setError=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isAllowsDetlDialogOpen=_useState12[0],setIsAllowsDetlDialogOpen=_useState12[1];var title=\"Site Allowances\";var _useDailyAllowancesCo=useDailyAllowancesContext(),dailyallowances=_useDailyAllowancesCo.dailyallowances,dailyallowsdetls=_useDailyAllowancesCo.dailyallowsdetls,loadEmpDailyAllowances=_useDailyAllowancesCo.loadEmpDailyAllowances,loadEmpDailyAllowsDetls=_useDailyAllowancesCo.loadEmpDailyAllowsDetls,dailyallowances_loading=_useDailyAllowancesCo.dailyallowances_loading,dailyallowances_error=_useDailyAllowancesCo.dailyallowances_error,updateDailyAllowance=_useDailyAllowancesCo.updateDailyAllowance,getSingleBatchDailyAllowsDetl=_useDailyAllowancesCo.getSingleBatchDailyAllowsDetl;// useEffect(() => {\n//   loadEmpDailyAllowances(loginLevel.loginUserId);\n// }, [toLoad]);\n// const myCustomSortingAlgorithm = {\n//   ascending: (a, b) => a.period.length - b.period.length,\n//   descending: (a, b) => b.period.length - a.period.length,\n// };\nvar columns=[{title:\"Name\",field:\"name\",editable:\"never\"},{title:\"Period\",field:\"period\",editable:\"never\"},{title:\"Location\",field:\"location\",editable:\"never\"},{title:\"Manager Name\",field:\"manager\",editable:\"never\"},{title:\"No Of Days\",field:\"no_of_days\",type:\"numeric\",editable:\"never\"},{title:\"Amount\",field:\"amount\",type:\"currency\",editable:\"never\"},{title:\"Status\",field:\"status\",editComponent:function editComponent(props){return/*#__PURE__*/_jsx(TextField//defaultValue={props.value || null}\n,{onChange:function onChange(e){return props.onChange(e.target.value);},style:{width:100},value:props.value,select:true,children:/*#__PURE__*/_jsx(MenuItem,{value:\"Pending\",children:\"Pending\"})});}}];var Save_DailyAllowancesData=function Save_DailyAllowancesData(){dailyallowances.forEach(function(data){var id=data.id;if(id){var _id=data.id,rec_id=data.rec_id,tableData=data.tableData,fields=_objectWithoutProperties(data,[\"id\",\"rec_id\",\"tableData\"]);updateDailyAllowance(_objectSpread({id:_id},fields));}});//handleDialogClose();\n};var update_SiteAllowsDetl=function update_SiteAllowsDetl(data){var id=data.id,empid=data.empid,period=data.period,no_of_days=data.no_of_days,amount=data.amount;loadEmpDailyAllowsDetls(empid,period);setAllows_period(period);setAllows_empid(empid);setAllowsdataId(id);setAllows_period(period);setAllows_empid(empid);setAllowsdataId(id);setAllowsdata(_objectSpread(_objectSpread({},allowsdata),{},{id:id,no_of_days:no_of_days,amount:amount,period:period,empid:empid}));//setIsAllowsDetlDialogOpen(true);\nhistory.push(\"/singledailyallowsdetlstable\");};var add_SiteAllowsPeriod=function add_SiteAllowsPeriod(){handleAddPeriodDialogOpen();};var handleAddPeriodDialogOpen=function handleAddPeriodDialogOpen(){setIsAddPeriodDialogOpen(true);};var handleAddPeriodDialogClose=function handleAddPeriodDialogClose(){setIsAddPeriodDialogOpen(false);};var handleAllowsDetlDialogOpen=function handleAllowsDetlDialogOpen(){setIsAllowsDetlDialogOpen(true);};var handleAllowsDetlDialogClose=function handleAllowsDetlDialogClose(){settoLoad(true);setIsAllowsDetlDialogOpen(false);};var Refresh_SiteAllows=function Refresh_SiteAllows(){loadEmpDailyAllowances(loginLevel.loginUserId);};return/*#__PURE__*/_jsx(\"div\",{className:classes.root,children:/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:\"100%\",paddingTop:\"5px\"},children:[/*#__PURE__*/_jsx(MaterialTable,{columns:columns,data:dailyallowances.filter(function(item){return item.empid===loginLevel.loginUserId;}),title:title,icons:{Add:function Add(props){return/*#__PURE__*/_jsx(AddIcon,{});},Edit:function Edit(props){return/*#__PURE__*/_jsx(EditIcon,{});},Delete:function Delete(props){return/*#__PURE__*/_jsx(DeleteIcon,{});},Clear:function Clear(props){return/*#__PURE__*/_jsx(DeleteIcon,{});},Check:function Check(props){return/*#__PURE__*/_jsx(CheckIcon,{});},Search:function Search(props){return/*#__PURE__*/_jsx(SearchIcon,{});},ResetSearch:function ResetSearch(props){return/*#__PURE__*/_jsx(DeleteIcon,{});}}// editable={{\n//   onRowUpdate: (newData, oldData) =>\n//     new Promise((resolve, reject) => {\n//       setTimeout(() => {\n//         // const dataUpdate = [...dailyallowances];\n//         // const index = oldData.tableData.id;\n//         // dataUpdate[index] = newData;\n//         //setDailyAllowances([...dataUpdate]);\n//         //approve_Expense(newData);\n//         update_AllowsDetl();\n//         resolve();\n//       }, 1000);\n//     }),\n// }}\n,actions:[{icon:\"add\",tooltip:\"Add Record\",isFreeAction:true,onClick:function onClick(event,rowData){add_SiteAllowsPeriod();}},function(rowData){return{disabled:rowData.status!==\"Pending\",icon:\"edit\",tooltip:\"Edit Record\",onClick:function onClick(event,rowData){update_SiteAllowsDetl(rowData);}};}],options:{filtering:true,sorting:true,headerStyle:{backgroundColor:\"orange\",color:\"#FFF\"},showTitle:true},components:{Toolbar:function Toolbar(props){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(MTableToolbar,_objectSpread({},props)),/*#__PURE__*/_jsx(\"div\",{style:{padding:\"5px 10px\"},children:error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",onClose:function onClose(){return setError(false);},children:\"Period already existed!\"})})]});}}}),/*#__PURE__*/_jsx(\"div\",{className:classes.dialog,children:/*#__PURE__*/_jsx(CustomDialog,{isOpen:isAddPeriodDialogOpen,handleClose:handleAddPeriodDialogClose,title:\"\",showButton:true,isFullscreen:false,isFullwidth:false,children:/*#__PURE__*/_jsx(DailyAllowancesAddPeriod,{handleDialogClose:handleAddPeriodDialogClose})})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(CustomDialog,{isOpen:isAllowsDetlDialogOpen,handleClose:handleAllowsDetlDialogClose,title:\"\",showButton:true,isFullscreen:false,isFullwidth:false,children:/*#__PURE__*/_jsx(DailyAllowsDetlsTableStaff,{allowsdata:allowsdata,allowsdataId:allowsdataId,handleDialogClose:handleAllowsDetlDialogClose})})})]})});}var useStyles=makeStyles(function(theme){return{root:{padding:0},dialog:{width:1000}};});","map":{"version":3,"sources":["D:/react-myprojects/hrms-airtable-july2/src/components/DailyAllowancesTableStaff.js"],"names":["React","useState","useEffect","useHistory","MaterialTable","MTableToolbar","makeStyles","TextField","Icon","Button","MenuItem","Alert","useSetRecoilState","useRecoilValue","useRecoilState","allowsPeriodState","allowsDataState","allowsDataDetlsState","allowsDataIdState","empidState","loginLevelState","AddIcon","EditIcon","DeleteIcon","CheckIcon","SearchIcon","CustomDialog","useDailyAllowancesContext","DailyAllowancesAddPeriod","DailyAllowsDetlsTableStaff","DailyAllowancesTableStaff","history","classes","useStyles","loginLevel","setLoginLevel","isAddPeriodDialogOpen","setIsAddPeriodDialogOpen","tmpallowsdata","setTmpallowsdata","allowsdata","setAllowsdata","allowsDetlsdata","setAllowsDetlsdata","allows_period","setAllows_period","allows_empid","setAllows_empid","allowsdataId","setAllowsdataId","toLoad","settoLoad","error","setError","isAllowsDetlDialogOpen","setIsAllowsDetlDialogOpen","title","dailyallowances","dailyallowsdetls","loadEmpDailyAllowances","loadEmpDailyAllowsDetls","dailyallowances_loading","dailyallowances_error","updateDailyAllowance","getSingleBatchDailyAllowsDetl","columns","field","editable","type","editComponent","props","e","onChange","target","value","width","Save_DailyAllowancesData","forEach","data","id","rec_id","tableData","fields","update_SiteAllowsDetl","empid","period","no_of_days","amount","push","add_SiteAllowsPeriod","handleAddPeriodDialogOpen","handleAddPeriodDialogClose","handleAllowsDetlDialogOpen","handleAllowsDetlDialogClose","Refresh_SiteAllows","loginUserId","root","maxWidth","paddingTop","filter","item","Add","Edit","Delete","Clear","Check","Search","ResetSearch","icon","tooltip","isFreeAction","onClick","event","rowData","disabled","status","filtering","sorting","headerStyle","backgroundColor","color","showTitle","Toolbar","padding","dialog","theme"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport MaterialTable, { MTableToolbar } from \"material-table\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { TextField, Icon, Button, MenuItem } from \"@material-ui/core\";\r\nimport { Alert } from \"@material-ui/lab\";\r\nimport { useSetRecoilState, useRecoilValue, useRecoilState } from \"recoil\";\r\nimport {\r\n  allowsPeriodState,\r\n  allowsDataState,\r\n  allowsDataDetlsState,\r\n  allowsDataIdState,\r\n  empidState,\r\n  loginLevelState,\r\n} from \"./data/atomdata\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport CheckIcon from \"@material-ui/icons/Check\";\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport { CustomDialog } from \"../helpers/CustomDialog\";\r\nimport { useDailyAllowancesContext } from \"../context/dailyallowances_context\";\r\nimport DailyAllowancesAddPeriod from \"./DailyAllowancesAddPeriod\";\r\nimport DailyAllowsDetlsTableStaff from \"./DailyAllowsDetlsTableStaff\";\r\n\r\nexport default function DailyAllowancesTableStaff() {\r\n  let history = useHistory();\r\n  const classes = useStyles();\r\n  const [loginLevel, setLoginLevel] = useRecoilState(loginLevelState);\r\n  const [isAddPeriodDialogOpen, setIsAddPeriodDialogOpen] = useState(false);\r\n  const [tmpallowsdata, setTmpallowsdata] = useState([]);\r\n  const [allowsdata, setAllowsdata] = useRecoilState(allowsDataState);\r\n  const [allowsDetlsdata, setAllowsDetlsdata] =\r\n    useRecoilState(allowsDataDetlsState);\r\n  const [allows_period, setAllows_period] = useRecoilState(allowsPeriodState);\r\n  const [allows_empid, setAllows_empid] = useRecoilState(empidState);\r\n  const [allowsdataId, setAllowsdataId] = useState(allowsDataIdState);\r\n  const [toLoad, settoLoad] = useState(true);\r\n  const [error, setError] = useState(\"\");\r\n  const [isAllowsDetlDialogOpen, setIsAllowsDetlDialogOpen] = useState(false);\r\n  const title = `Site Allowances`;\r\n  const {\r\n    dailyallowances,\r\n    dailyallowsdetls,\r\n    loadEmpDailyAllowances,\r\n    loadEmpDailyAllowsDetls,\r\n    dailyallowances_loading,\r\n    dailyallowances_error,\r\n    updateDailyAllowance,\r\n    getSingleBatchDailyAllowsDetl,\r\n  } = useDailyAllowancesContext();\r\n\r\n  // useEffect(() => {\r\n  //   loadEmpDailyAllowances(loginLevel.loginUserId);\r\n  // }, [toLoad]);\r\n\r\n  // const myCustomSortingAlgorithm = {\r\n  //   ascending: (a, b) => a.period.length - b.period.length,\r\n  //   descending: (a, b) => b.period.length - a.period.length,\r\n  // };\r\n\r\n  const columns = [\r\n    {\r\n      title: \"Name\",\r\n      field: \"name\",\r\n      editable: \"never\",\r\n    },\r\n    {\r\n      title: \"Period\",\r\n      field: \"period\",\r\n      editable: \"never\",\r\n    },\r\n    { title: \"Location\", field: \"location\", editable: \"never\" },\r\n    { title: \"Manager Name\", field: \"manager\", editable: \"never\" },\r\n    {\r\n      title: \"No Of Days\",\r\n      field: \"no_of_days\",\r\n      type: \"numeric\",\r\n      editable: \"never\",\r\n    },\r\n    { title: \"Amount\", field: \"amount\", type: \"currency\", editable: \"never\" },\r\n    {\r\n      title: \"Status\",\r\n      field: \"status\",\r\n      editComponent: (props) => (\r\n        <TextField\r\n          //defaultValue={props.value || null}\r\n          onChange={(e) => props.onChange(e.target.value)}\r\n          style={{ width: 100 }}\r\n          value={props.value}\r\n          select\r\n        >\r\n          <MenuItem value=\"Pending\">Pending</MenuItem>\r\n          {/* <MenuItem value=\"Approve\">Approve</MenuItem>\r\n        <MenuItem value=\"Reject\">Reject</MenuItem>\r\n        <MenuItem value=\"Cancel\">Cancel</MenuItem> */}\r\n        </TextField>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  const Save_DailyAllowancesData = () => {\r\n    dailyallowances.forEach((data) => {\r\n      const { id } = data;\r\n      if (id) {\r\n        const { id, rec_id, tableData, ...fields } = data;\r\n        updateDailyAllowance({ id, ...fields });\r\n      }\r\n    });\r\n\r\n    //handleDialogClose();\r\n  };\r\n\r\n  const update_SiteAllowsDetl = (data) => {\r\n    const { id, empid, period, no_of_days, amount } = data;\r\n\r\n    loadEmpDailyAllowsDetls(empid, period);\r\n   \r\n    setAllows_period(period);\r\n    setAllows_empid(empid);\r\n    setAllowsdataId(id);\r\n    setAllows_period(period);\r\n    setAllows_empid(empid);\r\n    setAllowsdataId(id);\r\n    setAllowsdata({\r\n      ...allowsdata,\r\n      id: id,\r\n      no_of_days: no_of_days,\r\n      amount: amount,\r\n      period: period,\r\n      empid: empid,\r\n    });\r\n\r\n    //setIsAllowsDetlDialogOpen(true);\r\n    history.push(\"/singledailyallowsdetlstable\");\r\n  };\r\n\r\n  const add_SiteAllowsPeriod = () => {\r\n    handleAddPeriodDialogOpen();\r\n  };\r\n\r\n  const handleAddPeriodDialogOpen = () => {\r\n    setIsAddPeriodDialogOpen(true);\r\n  };\r\n\r\n  const handleAddPeriodDialogClose = () => {\r\n    setIsAddPeriodDialogOpen(false);\r\n  };\r\n\r\n  const handleAllowsDetlDialogOpen = () => {\r\n    setIsAllowsDetlDialogOpen(true);\r\n  };\r\n\r\n  const handleAllowsDetlDialogClose = () => {\r\n    settoLoad(true);\r\n    setIsAllowsDetlDialogOpen(false);\r\n  };\r\n\r\n  const Refresh_SiteAllows = () => {\r\n    loadEmpDailyAllowances(loginLevel.loginUserId);\r\n  };\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <div style={{ maxWidth: \"100%\", paddingTop: \"5px\" }}>\r\n        <MaterialTable\r\n          columns={columns}\r\n          data={dailyallowances.filter(\r\n            (item) => item.empid === loginLevel.loginUserId\r\n          )}\r\n          title={title}\r\n          icons={{\r\n            Add: (props) => <AddIcon />,\r\n            Edit: (props) => <EditIcon />,\r\n            Delete: (props) => <DeleteIcon />,\r\n            Clear: (props) => <DeleteIcon />,\r\n            Check: (props) => <CheckIcon />,\r\n            Search: (props) => <SearchIcon />,\r\n            ResetSearch: (props) => <DeleteIcon />,\r\n          }}\r\n          // editable={{\r\n          //   onRowUpdate: (newData, oldData) =>\r\n          //     new Promise((resolve, reject) => {\r\n          //       setTimeout(() => {\r\n          //         // const dataUpdate = [...dailyallowances];\r\n          //         // const index = oldData.tableData.id;\r\n          //         // dataUpdate[index] = newData;\r\n          //         //setDailyAllowances([...dataUpdate]);\r\n          //         //approve_Expense(newData);\r\n          //         update_AllowsDetl();\r\n          //         resolve();\r\n          //       }, 1000);\r\n          //     }),\r\n          // }}\r\n          actions={[\r\n            {\r\n              icon: \"add\",\r\n              tooltip: \"Add Record\",\r\n              isFreeAction: true,\r\n              onClick: (event, rowData) => {\r\n                add_SiteAllowsPeriod();\r\n              },\r\n            },\r\n            (rowData) => ({\r\n              disabled: rowData.status !== \"Pending\",\r\n              icon: \"edit\",\r\n              tooltip: \"Edit Record\",\r\n              onClick: (event, rowData) => {\r\n                update_SiteAllowsDetl(rowData);\r\n              },\r\n            }),\r\n          ]}\r\n          options={{\r\n            filtering: true,\r\n            sorting: true,\r\n            headerStyle: {\r\n              backgroundColor: \"orange\",\r\n              color: \"#FFF\",\r\n            },\r\n            showTitle: true,\r\n          }}\r\n          components={{\r\n            Toolbar: (props) => (\r\n              <div>\r\n                <MTableToolbar {...props} />\r\n\r\n                <div style={{ padding: \"5px 10px\" }}>\r\n                  {error && (\r\n                    <Alert severity=\"error\" onClose={() => setError(false)}>\r\n                      Period already existed!\r\n                    </Alert>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ),\r\n          }}\r\n        />\r\n        <div className={classes.dialog}>\r\n          <CustomDialog\r\n            isOpen={isAddPeriodDialogOpen}\r\n            handleClose={handleAddPeriodDialogClose}\r\n            title=\"\"\r\n            showButton={true}\r\n            isFullscreen={false}\r\n            isFullwidth={false}\r\n          >\r\n            <DailyAllowancesAddPeriod\r\n              handleDialogClose={handleAddPeriodDialogClose}\r\n            />\r\n          </CustomDialog>\r\n        </div>\r\n        <div>\r\n          <CustomDialog\r\n            isOpen={isAllowsDetlDialogOpen}\r\n            handleClose={handleAllowsDetlDialogClose}\r\n            title=\"\"\r\n            showButton={true}\r\n            isFullscreen={false}\r\n            isFullwidth={false}\r\n          >\r\n            <DailyAllowsDetlsTableStaff\r\n              allowsdata={allowsdata}\r\n              allowsdataId={allowsdataId}\r\n              handleDialogClose={handleAllowsDetlDialogClose}\r\n            />\r\n          </CustomDialog>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    padding: 0,\r\n  },\r\n  dialog: {\r\n    width: 1000,\r\n  },\r\n}));\r\n"]},"metadata":{},"sourceType":"module"}