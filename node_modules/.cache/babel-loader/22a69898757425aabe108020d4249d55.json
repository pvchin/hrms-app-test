{"ast":null,"code":"import _toConsumableArray from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _slicedToArray from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useHistory,Link}from\"react-router-dom\";import MaterialTable,{MTableToolbar}from\"material-table\";import{makeStyles}from\"@material-ui/core/styles\";import{TextField,Icon,Grid,Button}from\"@material-ui/core\";import{Alert}from\"@material-ui/lab\";import{useRecoilValue,useRecoilState}from\"recoil\";import{loginLevelState,allowsDataState,allowsDataDetlsState,empidState,allowsPeriodState,allowsDataIdState}from\"./data/atomdata\";import{useDailyAllowancesContext}from\"../context/dailyallowances_context\";import{useDailyAllowsDetls}from\"./dailyallowsdetls/useDailyAllowsDetls\";import{useAddDailyAllowsDetls}from\"./dailyallowsdetls/useAddDailyAllowsDetls\";import{useUpdateDailyAllowsDetls}from\"./dailyallowsdetls/useUpdateDailyAllowsDetls\";import{useDeleteDailyAllowsDetls}from\"./dailyallowsdetls/useDeleteDailyAllowsDetls\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var columns=[{title:\"Date\",field:\"date\",type:\"date\",dateSetting:{locale:\"en-GB\"},// editable: \"never\",\ncellStyle:{width:120,maxWidth:120},editComponent:function editComponent(props){return/*#__PURE__*/_jsx(TextField,{defaultValue:props.value||null,onChange:function onChange(e){return props.onChange(e.target.value);},type:\"date\"});}},{title:\"District\",field:\"district\"},{title:\"Operation Type\",field:\"typeoperation\"},{title:\"Client\",field:\"client\"},{title:\"Location/Rig\",field:\"location\"},{title:\"Ticket No/Job No\",field:\"jobno\"},{title:\"Crew Operation\",field:\"crewoperation\"},{title:\"Job Bonus\",field:\"jobbonus\",type:\"currency\",cellStyle:{width:8,maxWidth:8},headerStyle:{width:8,maxWidth:8}},{title:\"Per Diem\",field:\"perdiem\",type:\"currency\",cellStyle:{width:8,maxWidth:8},headerStyle:{width:8,maxWidth:8}},{title:\"Delete\",field:\"isdelete\",type:\"boolean\"}];export default function DailyAllowsDetlsTableStaff(){var history=useHistory();var classes=useStyles();//const { dailyallowsdetls } = useDailyAllowsDetls()\nvar addDailyAllowsDetls=useAddDailyAllowsDetls();var updateDailyAllowsDetls=useUpdateDailyAllowsDetls();var deleteDailyAllowsDetls=useDeleteDailyAllowsDetls();// const [allowsDetlsTable, setAllowsDetlsTable] =\n// useRecoilState(allowsDataDetlsState);\n//console.log(\"detlstable\", );\n//const [allowsDetlsdata, setAllowsDetilsdata] = useRecoilStateLoadable(fetchDailyAllowsDetlsSelector);\nvar _useRecoilState=useRecoilState(loginLevelState),_useRecoilState2=_slicedToArray(_useRecoilState,2),loginLevel=_useRecoilState2[0],setLoginLevel=_useRecoilState2[1];var _useRecoilState3=useRecoilState(allowsDataDetlsState),_useRecoilState4=_slicedToArray(_useRecoilState3,2),allowsDetlsdata=_useRecoilState4[0],setAllowsDetlsdata=_useRecoilState4[1];var allows_period=useRecoilValue(allowsPeriodState);var allows_empid=useRecoilValue(empidState);var _useRecoilState5=useRecoilState(allowsDataState),_useRecoilState6=_slicedToArray(_useRecoilState5,2),allowsdata=_useRecoilState6[0],setAllowsdata=_useRecoilState6[1];var _useState=useState(allowsDataIdState),_useState2=_slicedToArray(_useState,2),allowsdataId=_useState2[0],setAllowsdataId=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),tabledeldata=_useState4[0],setTableDelData=_useState4[1];var _useState5=useState({totaldays:0,totalamount:0,totalbonus:0,totaldiem:0}),_useState6=_slicedToArray(_useState5,2),totals=_useState6[0],setTotals=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),alert=_useState8[0],setAlert=_useState8[1];var _useDailyAllowancesCo=useDailyAllowancesContext(),dailyallowances=_useDailyAllowancesCo.dailyallowances,dailyallowsdetls=_useDailyAllowancesCo.dailyallowsdetls,loadEmpDailyAllowsDetls=_useDailyAllowancesCo.loadEmpDailyAllowsDetls,updateDailyAllowance=_useDailyAllowancesCo.updateDailyAllowance,updateDailyAllowsDetl=_useDailyAllowancesCo.updateDailyAllowsDetl,deleteDailyAllowsDetl=_useDailyAllowancesCo.deleteDailyAllowsDetl,dailyallowsdetl_loading=_useDailyAllowancesCo.dailyallowsdetl_loading,dailyallowsdetl_error=_useDailyAllowancesCo.dailyallowsdetl_error;// useEffect(() => {\n//   console.log(\"useeffect load detls\")\n//   getSingleBatchDailyAllowsDetl(allows_empid, allows_period);\n// }, [allows_period]);\n// useEffect(() => {\n//   loadEmpDailyAllowsDetls(empid, period);\n//   // eslint-disable-next-line react-hooks/exhaustive-deps\n// }, []);\nuseEffect(function(){//calc\nhandle_calc();},[dailyallowsdetls]);var update_AllowsDetls=function update_AllowsDetls(data,index){var recdata=dailyallowsdetls.filter(function(r){return r.tableData.id===index;});recdata[0].typeoperation=data.typeoperation;recdata[0].client=data.client;recdata[0].district=data.district;recdata[0].location=data.location;recdata[0].jobno=data.jobno;recdata[0].crewoperation=data.crewoperation;recdata[0].jobbonus=data.jobbonus;recdata[0].perdiem=data.perdiem;//calc\nhandle_calc();};var save_AllowsDetls=function save_AllowsDetls(e){e.preventDefault();// eslint-disable-next-line no-lone-blocks\n{dailyallowsdetls.forEach(function(rec){var id=rec.id,rec_id=rec.rec_id,tableData=rec.tableData,fields=_objectWithoutProperties(rec,[\"id\",\"rec_id\",\"tableData\"]);updateDailyAllowsDetl(_objectSpread({id:id},fields));});}//save allows data details\nvar id=allowsdata.id;updateDailyAllowance(_objectSpread(_objectSpread({id:id},allowsdata),{},{no_of_days:totals.totaldays,amount:totals.totalamount}));var dailydata=dailyallowances.filter(function(r){return r.id===id;});dailydata[0].no_of_days=totals.totaldays;dailydata[0].amount=totals.totalamount;console.log(\"daily detils update\",dailydata,dailyallowances);setAlert(true);};var delete_AllowsDetls=function delete_AllowsDetls(data,index){dailyallowsdetls.forEach(function(rec){if(rec.tableData.checked){deleteDailyAllowsDetl(rec.id);}});loadEmpDailyAllowsDetls(allows_empid,allows_period);};// const delete_AllowsDetls = () => {\n//   dailyallowsdetls.forEach((rec, index) => {\n//     if (rec.tableData.checked) {\n//       const recdata = dailyallowsdetls[index];\n//       recdata.isdelete = true;\n//       setTableDelData(prevState => ({\n//         tabledeldata: [...prevState, recdata]\n//       }))\n//       console.log(\"delete detls\", tabledeldata)\n//       //deleteDailyAllowsDetl(rec.id);\n//     }\n//   });\n//   console.log(\"delete allowsdetls\", dailyallowsdetls);\n// };\nvar handle_refresh=function handle_refresh(){//  getSingleBatchDailyAllowsDetl(allows_empid, allows_period);\n};var handle_calc=function handle_calc(){var totbonus=dailyallowsdetls.reduce(function(acc,item){return acc+item.jobbonus;},0);var totdiem=dailyallowsdetls.reduce(function(acc,item){return acc+item.perdiem;},0);var totdays=dailyallowsdetls.reduce(function(acc,item){return acc+1;},0);var total=totbonus+totdiem;setTotals({totalamount:total,totalbonus:totbonus,totaldiem:totdiem,totaldays:totdays});};// const add_DailyAllowsDetl = async (data) => {\n//   console.log(\"add\", data);\n//   const { description, amount } = data;\n//   addDailyAllowsDetl({\n//     description: description,\n//     amount: amount,\n//     name: single_dailyallowance.name,\n//     empid: single_dailyallowance.empid,\n//     period: dailyallowance_period,\n//   });\n// };\n// const delete_DailyAllowance = (data) => {\n//   const { id } = data;\n//   deleteDailyAllowsDetl(id);\n//   //update_Daily Allowances Details;\n//   getSingleBatchDailyAllowsDetl(\n//     single_dailyallowance.empid,\n//     dailyallowance_period\n//   );\n// };\nif(dailyallowsdetl_loading){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Loading.... daily site allowances\"})});}if(dailyallowsdetl_error){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Internet connection problem!\"})});}if(!dailyallowsdetl_loading){//  setAllowsDetlsdata(dailyallowsdetls);\n// console.log(\"load allows detls\", allowsDetlsdata);\nreturn/*#__PURE__*/_jsx(\"div\",{className:classes.root,children:/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:\"75%\",paddingTop:\"5px\"},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Allows Detils Table\"}),/*#__PURE__*/_jsx(MaterialTable,{columns:columns,data:dailyallowsdetls.filter(function(item){return item.empid===loginLevel.loginUserId&&!item.isdelete;}),title:\"Daily Allowances Details\",editable:{onRowAdd:function onRowAdd(newData){return new Promise(function(resolve,reject){// setTimeout(() => {\n//   setAllowsdata([...allowsdata, newData]);\n//   resolve();\n// }, 1000);\n});},onRowUpdate:function onRowUpdate(newData,oldData){return new Promise(function(resolve,reject){setTimeout(function(){var dataUpdate=_toConsumableArray(dailyallowsdetls);var index=oldData.tableData.id;dataUpdate[index]=newData;update_AllowsDetls(newData,index);//setAllowsDetlsTable([...dataUpdate]);\n//editable = dataUpdate;\nresolve();},1000);});}// onRowDelete: (oldData) =>\n//   new Promise((resolve, reject) => {\n//     setTimeout(() => {\n//       //const dataDelete = [...allowsDetlsTable];\n//       const index = oldData.tableData.id;\n//       //dataDelete.splice(index, 1);\n//       //setAllowsDetlsTable([...dataDelete]);\n//       resolve();\n//     }, 1000);\n//   }),\n},options:{filtering:true,selection:true,pageSize:10,headerStyle:{backgroundColor:\"orange\",color:\"primary\"},showTitle:true},components:{Toolbar:function Toolbar(props){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(MTableToolbar,_objectSpread({},props)),/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"5px 10px\"},children:[/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"secondary\",className:classes.button,onClick:function onClick(e){return delete_AllowsDetls(e);},children:\"delete\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"secondary\",className:classes.button,onClick:function onClick(e){return handle_calc(e);},children:\"re-calc\"}),/*#__PURE__*/_jsxs(Button,{type:\"submit\",variant:\"contained\",color:\"secondary\",className:classes.button,onClick:function onClick(e){return save_AllowsDetls(e);},children:[\"Update all \",/*#__PURE__*/_jsx(Icon,{className:classes.rightIcon,children:\"send\"})]}),alert&&/*#__PURE__*/_jsx(Alert,{severity:\"success\",onClose:function onClose(){return setAlert(false);},children:\"Changes being saved!\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Grid,{container:true,spacing:0,direction:\"row\",alignItems:\"left\"//justify=\"left\"\n,style:{border:\"1px solid white\"},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"row\"},children:[/*#__PURE__*/_jsx(TextField,{label:\"Total Job Bonus\",variant:\"filled\",style:{width:\"100%\"},name:\"totalbonus\",value:totals.totalbonus,type:\"currency\",className:classes.textField,InputLabelProps:{shrink:true}}),/*#__PURE__*/_jsx(TextField,{label:\"Total Diem\",variant:\"filled\",style:{width:\"100%\"},name:\"totaldiem\",value:totals.totaldiem,type:\"currency\",className:classes.textField,InputLabelProps:{shrink:true}}),/*#__PURE__*/_jsx(TextField,{label:\"No of Days\",variant:\"filled\",style:{width:\"100%\"},name:\"totaldays\",value:totals.totaldays,type:\"numeric\",className:classes.textField,InputLabelProps:{shrink:true}}),/*#__PURE__*/_jsx(TextField,{label:\"Total Amount\",variant:\"filled\",style:{width:\"100%\"},name:\"totalamount\",value:totals.totalamount,type:\"currency\",className:classes.textField,InputLabelProps:{shrink:true}})]})})})]})]});}}})]})});}}var useStyles=makeStyles(function(theme){return{root:{padding:0,width:1500},button:{margin:theme.spacing(1)}};});","map":{"version":3,"sources":["D:/react-myprojects/hrms-airtable-july2/src/components/DailyAllowsDetlsTableStaff.js"],"names":["React","useState","useEffect","useHistory","Link","MaterialTable","MTableToolbar","makeStyles","TextField","Icon","Grid","Button","Alert","useRecoilValue","useRecoilState","loginLevelState","allowsDataState","allowsDataDetlsState","empidState","allowsPeriodState","allowsDataIdState","useDailyAllowancesContext","useDailyAllowsDetls","useAddDailyAllowsDetls","useUpdateDailyAllowsDetls","useDeleteDailyAllowsDetls","columns","title","field","type","dateSetting","locale","cellStyle","width","maxWidth","editComponent","props","value","e","onChange","target","headerStyle","DailyAllowsDetlsTableStaff","history","classes","useStyles","addDailyAllowsDetls","updateDailyAllowsDetls","deleteDailyAllowsDetls","loginLevel","setLoginLevel","allowsDetlsdata","setAllowsDetlsdata","allows_period","allows_empid","allowsdata","setAllowsdata","allowsdataId","setAllowsdataId","tabledeldata","setTableDelData","totaldays","totalamount","totalbonus","totaldiem","totals","setTotals","alert","setAlert","dailyallowances","dailyallowsdetls","loadEmpDailyAllowsDetls","updateDailyAllowance","updateDailyAllowsDetl","deleteDailyAllowsDetl","dailyallowsdetl_loading","dailyallowsdetl_error","handle_calc","update_AllowsDetls","data","index","recdata","filter","r","tableData","id","typeoperation","client","district","location","jobno","crewoperation","jobbonus","perdiem","save_AllowsDetls","preventDefault","forEach","rec","rec_id","fields","no_of_days","amount","dailydata","console","log","delete_AllowsDetls","checked","handle_refresh","totbonus","reduce","acc","item","totdiem","totdays","total","root","paddingTop","empid","loginUserId","isdelete","onRowAdd","newData","Promise","resolve","reject","onRowUpdate","oldData","setTimeout","dataUpdate","filtering","selection","pageSize","backgroundColor","color","showTitle","Toolbar","padding","button","rightIcon","border","display","flexDirection","textField","shrink","theme","margin","spacing"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useHistory, Link } from \"react-router-dom\";\r\nimport MaterialTable, { MTableToolbar } from \"material-table\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { TextField, Icon, Grid, Button } from \"@material-ui/core\";\r\nimport { Alert } from \"@material-ui/lab\";\r\nimport { useRecoilValue, useRecoilState } from \"recoil\";\r\nimport {\r\n  loginLevelState,\r\n  allowsDataState,\r\n  allowsDataDetlsState,\r\n  empidState,\r\n  allowsPeriodState,\r\n  allowsDataIdState,\r\n} from \"./data/atomdata\";\r\nimport { useDailyAllowancesContext } from \"../context/dailyallowances_context\";\r\nimport { useDailyAllowsDetls } from \"./dailyallowsdetls/useDailyAllowsDetls\"\r\nimport { useAddDailyAllowsDetls } from \"./dailyallowsdetls/useAddDailyAllowsDetls\";\r\nimport { useUpdateDailyAllowsDetls } from \"./dailyallowsdetls/useUpdateDailyAllowsDetls\";\r\nimport { useDeleteDailyAllowsDetls } from \"./dailyallowsdetls/useDeleteDailyAllowsDetls\";\r\n\r\nconst columns = [\r\n  {\r\n    title: \"Date\",\r\n    field: \"date\",\r\n    type: \"date\",\r\n    dateSetting: { locale: \"en-GB\" },\r\n    // editable: \"never\",\r\n    cellStyle: {\r\n      width: 120,\r\n      maxWidth: 120,\r\n    },\r\n    editComponent: (props) => (\r\n      <TextField\r\n        defaultValue={props.value || null}\r\n        onChange={(e) => props.onChange(e.target.value)}\r\n        type=\"date\"\r\n      />\r\n    ),\r\n  },\r\n  { title: \"District\", field: \"district\" },\r\n  { title: \"Operation Type\", field: \"typeoperation\" },\r\n  { title: \"Client\", field: \"client\" },\r\n  { title: \"Location/Rig\", field: \"location\" },\r\n  { title: \"Ticket No/Job No\", field: \"jobno\" },\r\n  { title: \"Crew Operation\", field: \"crewoperation\" },\r\n  {\r\n    title: \"Job Bonus\",\r\n    field: \"jobbonus\",\r\n    type: \"currency\",\r\n    cellStyle: {\r\n      width: 8,\r\n      maxWidth: 8,\r\n    },\r\n    headerStyle: {\r\n      width: 8,\r\n      maxWidth: 8,\r\n    },\r\n  },\r\n  {\r\n    title: \"Per Diem\",\r\n    field: \"perdiem\",\r\n    type: \"currency\",\r\n    cellStyle: {\r\n      width: 8,\r\n      maxWidth: 8,\r\n    },\r\n    headerStyle: {\r\n      width: 8,\r\n      maxWidth: 8,\r\n    },\r\n  },\r\n  { title: \"Delete\", field: \"isdelete\", type: \"boolean\" },\r\n];\r\n\r\nexport default function DailyAllowsDetlsTableStaff() {\r\n  let history = useHistory();\r\n  const classes = useStyles();\r\n  //const { dailyallowsdetls } = useDailyAllowsDetls()\r\n  const addDailyAllowsDetls = useAddDailyAllowsDetls()\r\n  const updateDailyAllowsDetls = useUpdateDailyAllowsDetls();\r\n  const deleteDailyAllowsDetls = useDeleteDailyAllowsDetls();\r\n\r\n  // const [allowsDetlsTable, setAllowsDetlsTable] =\r\n  // useRecoilState(allowsDataDetlsState);\r\n  //console.log(\"detlstable\", );\r\n  //const [allowsDetlsdata, setAllowsDetilsdata] = useRecoilStateLoadable(fetchDailyAllowsDetlsSelector);\r\n  const [loginLevel, setLoginLevel] = useRecoilState(loginLevelState);\r\n  const [allowsDetlsdata, setAllowsDetlsdata] =\r\n    useRecoilState(allowsDataDetlsState);\r\n  const allows_period = useRecoilValue(allowsPeriodState);\r\n  const allows_empid = useRecoilValue(empidState);\r\n  const [allowsdata, setAllowsdata] = useRecoilState(allowsDataState);\r\n  const [allowsdataId, setAllowsdataId] = useState(allowsDataIdState);\r\n  const [tabledeldata, setTableDelData] = useState({});\r\n  const [totals, setTotals] = useState({\r\n    totaldays: 0,\r\n    totalamount: 0,\r\n    totalbonus: 0,\r\n    totaldiem: 0,\r\n  });\r\n  const [alert, setAlert] = useState(false);\r\n  const {\r\n    dailyallowances,\r\n    dailyallowsdetls,\r\n    loadEmpDailyAllowsDetls,\r\n    updateDailyAllowance,\r\n    updateDailyAllowsDetl,\r\n    deleteDailyAllowsDetl,\r\n    dailyallowsdetl_loading,\r\n    dailyallowsdetl_error,\r\n  } = useDailyAllowancesContext();\r\n\r\n  // useEffect(() => {\r\n  //   console.log(\"useeffect load detls\")\r\n  //   getSingleBatchDailyAllowsDetl(allows_empid, allows_period);\r\n  // }, [allows_period]);\r\n\r\n  // useEffect(() => {\r\n  //   loadEmpDailyAllowsDetls(empid, period);\r\n  //   // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  // }, []);\r\n\r\n  useEffect(() => {\r\n    //calc\r\n    handle_calc();\r\n  }, [dailyallowsdetls]);\r\n\r\n  const update_AllowsDetls = (data, index) => {\r\n    const recdata = dailyallowsdetls.filter((r) => r.tableData.id === index);\r\n    recdata[0].typeoperation = data.typeoperation;\r\n    recdata[0].client = data.client;\r\n    recdata[0].district = data.district;\r\n    recdata[0].location = data.location;\r\n    recdata[0].jobno = data.jobno;\r\n    recdata[0].crewoperation = data.crewoperation;\r\n    recdata[0].jobbonus = data.jobbonus;\r\n    recdata[0].perdiem = data.perdiem;\r\n    //calc\r\n    handle_calc();\r\n  };\r\n\r\n  const save_AllowsDetls = (e) => {\r\n    e.preventDefault();\r\n    // eslint-disable-next-line no-lone-blocks\r\n    {\r\n      dailyallowsdetls.forEach((rec) => {\r\n        const { id, rec_id, tableData, ...fields } = rec;\r\n        updateDailyAllowsDetl({ id, ...fields });\r\n      });\r\n    }\r\n\r\n    //save allows data details\r\n    const { id } = allowsdata;\r\n    updateDailyAllowance({\r\n      id: id,\r\n      ...allowsdata,\r\n      no_of_days: totals.totaldays,\r\n      amount: totals.totalamount,\r\n    });\r\n    const dailydata = dailyallowances.filter((r) => r.id === id);\r\n\r\n    dailydata[0].no_of_days = totals.totaldays;\r\n    dailydata[0].amount = totals.totalamount;\r\n    console.log(\"daily detils update\", dailydata, dailyallowances);\r\n    setAlert(true);\r\n  };\r\n\r\n  const delete_AllowsDetls = (data, index) => {\r\n    dailyallowsdetls.forEach((rec) => {\r\n      if (rec.tableData.checked) {\r\n        deleteDailyAllowsDetl(rec.id);\r\n      }\r\n    });\r\n    loadEmpDailyAllowsDetls(allows_empid, allows_period);\r\n  };\r\n\r\n  // const delete_AllowsDetls = () => {\r\n  //   dailyallowsdetls.forEach((rec, index) => {\r\n  //     if (rec.tableData.checked) {\r\n  //       const recdata = dailyallowsdetls[index];\r\n  //       recdata.isdelete = true;\r\n  //       setTableDelData(prevState => ({\r\n  //         tabledeldata: [...prevState, recdata]\r\n  //       }))\r\n  //       console.log(\"delete detls\", tabledeldata)\r\n  //       //deleteDailyAllowsDetl(rec.id);\r\n  //     }\r\n  //   });\r\n  //   console.log(\"delete allowsdetls\", dailyallowsdetls);\r\n  // };\r\n\r\n  const handle_refresh = () => {\r\n    //  getSingleBatchDailyAllowsDetl(allows_empid, allows_period);\r\n  };\r\n\r\n  const handle_calc = () => {\r\n    const totbonus = dailyallowsdetls.reduce((acc, item) => {\r\n      return acc + item.jobbonus;\r\n    }, 0);\r\n    const totdiem = dailyallowsdetls.reduce((acc, item) => {\r\n      return acc + item.perdiem;\r\n    }, 0);\r\n    const totdays = dailyallowsdetls.reduce((acc, item) => {\r\n      return acc + 1;\r\n    }, 0);\r\n    const total = totbonus + totdiem;\r\n    setTotals({\r\n      totalamount: total,\r\n      totalbonus: totbonus,\r\n      totaldiem: totdiem,\r\n      totaldays: totdays,\r\n    });\r\n  };\r\n\r\n  // const add_DailyAllowsDetl = async (data) => {\r\n  //   console.log(\"add\", data);\r\n  //   const { description, amount } = data;\r\n  //   addDailyAllowsDetl({\r\n  //     description: description,\r\n  //     amount: amount,\r\n  //     name: single_dailyallowance.name,\r\n  //     empid: single_dailyallowance.empid,\r\n  //     period: dailyallowance_period,\r\n  //   });\r\n  // };\r\n\r\n  // const delete_DailyAllowance = (data) => {\r\n  //   const { id } = data;\r\n  //   deleteDailyAllowsDetl(id);\r\n  //   //update_Daily Allowances Details;\r\n  //   getSingleBatchDailyAllowsDetl(\r\n  //     single_dailyallowance.empid,\r\n  //     dailyallowance_period\r\n  //   );\r\n  // };\r\n\r\n  if (dailyallowsdetl_loading) {\r\n    return (\r\n      <div>\r\n        <h2>Loading.... daily site allowances</h2>\r\n      </div>\r\n    );\r\n  }\r\n  if (dailyallowsdetl_error) {\r\n    return (\r\n      <div>\r\n        <h2>Internet connection problem!</h2>\r\n      </div>\r\n    );\r\n  }\r\n  if (!dailyallowsdetl_loading) {\r\n    //  setAllowsDetlsdata(dailyallowsdetls);\r\n\r\n    // console.log(\"load allows detls\", allowsDetlsdata);\r\n    return (\r\n      <div className={classes.root}>\r\n        {/* <h1>Expenses Claims Application</h1> */}\r\n\r\n        <div style={{ maxWidth: \"75%\", paddingTop: \"5px\" }}>\r\n          <h2>Allows Detils Table</h2>\r\n          <MaterialTable\r\n            columns={columns}\r\n            data={dailyallowsdetls.filter(\r\n              (item) => item.empid === loginLevel.loginUserId && !item.isdelete\r\n            )}\r\n            title=\"Daily Allowances Details\"\r\n            editable={{\r\n              onRowAdd: (newData) =>\r\n                new Promise((resolve, reject) => {\r\n                  // setTimeout(() => {\r\n                  //   setAllowsdata([...allowsdata, newData]);\r\n                  //   resolve();\r\n                  // }, 1000);\r\n                }),\r\n              onRowUpdate: (newData, oldData) =>\r\n                new Promise((resolve, reject) => {\r\n                  setTimeout(() => {\r\n                    const dataUpdate = [...dailyallowsdetls];\r\n                    const index = oldData.tableData.id;\r\n                    dataUpdate[index] = newData;\r\n                    update_AllowsDetls(newData, index);\r\n                    //setAllowsDetlsTable([...dataUpdate]);\r\n                    //editable = dataUpdate;\r\n                    resolve();\r\n                  }, 1000);\r\n                }),\r\n              // onRowDelete: (oldData) =>\r\n              //   new Promise((resolve, reject) => {\r\n              //     setTimeout(() => {\r\n              //       //const dataDelete = [...allowsDetlsTable];\r\n              //       const index = oldData.tableData.id;\r\n              //       //dataDelete.splice(index, 1);\r\n              //       //setAllowsDetlsTable([...dataDelete]);\r\n\r\n              //       resolve();\r\n              //     }, 1000);\r\n              //   }),\r\n            }}\r\n            options={{\r\n              filtering: true,\r\n              selection: true,\r\n               pageSize:10,\r\n              headerStyle: {\r\n                backgroundColor: \"orange\",\r\n                color: \"primary\",\r\n              },\r\n              showTitle: true,\r\n            }}\r\n            components={{\r\n              Toolbar: (props) => (\r\n                <div>\r\n                  <MTableToolbar {...props} />\r\n                  <div style={{ padding: \"5px 10px\" }}>\r\n                    <Button\r\n                      type=\"submit\"\r\n                      variant=\"contained\"\r\n                      color=\"secondary\"\r\n                      className={classes.button}\r\n                      onClick={(e) => delete_AllowsDetls(e)}\r\n                    >\r\n                      delete\r\n                    </Button>\r\n                    {/* <Button\r\n                    type=\"submit\"\r\n                    variant=\"contained\"\r\n                    color=\"secondary\"\r\n                    className={classes.button}\r\n                    onClick={(e) => handle_refresh(e)}\r\n                  >\r\n                    re-fresh\r\n                  </Button> */}\r\n                    <Button\r\n                      type=\"submit\"\r\n                      variant=\"contained\"\r\n                      color=\"secondary\"\r\n                      className={classes.button}\r\n                      onClick={(e) => handle_calc(e)}\r\n                    >\r\n                      re-calc\r\n                    </Button>\r\n                    <Button\r\n                      type=\"submit\"\r\n                      variant=\"contained\"\r\n                      color=\"secondary\"\r\n                      className={classes.button}\r\n                      onClick={(e) => save_AllowsDetls(e)}\r\n                    >\r\n                      Update all <Icon className={classes.rightIcon}>send</Icon>\r\n                    </Button>\r\n                    {alert && (\r\n                      <Alert severity=\"success\" onClose={() => setAlert(false)}>\r\n                        Changes being saved!\r\n                      </Alert>\r\n                    )}\r\n                    <div>\r\n                      <Grid\r\n                        container\r\n                        spacing={0}\r\n                        direction=\"row\"\r\n                        alignItems=\"left\"\r\n                        //justify=\"left\"\r\n                        style={{ border: \"1px solid white\" }}\r\n                      >\r\n                        <div style={{ display: \"flex\", flexDirection: \"row\" }}>\r\n                          <TextField\r\n                            label=\"Total Job Bonus\"\r\n                            variant=\"filled\"\r\n                            style={{ width: \"100%\" }}\r\n                            name=\"totalbonus\"\r\n                            value={totals.totalbonus}\r\n                            type=\"currency\"\r\n                            className={classes.textField}\r\n                            InputLabelProps={{\r\n                              shrink: true,\r\n                            }}\r\n                          ></TextField>\r\n                          <TextField\r\n                            label=\"Total Diem\"\r\n                            variant=\"filled\"\r\n                            style={{ width: \"100%\" }}\r\n                            name=\"totaldiem\"\r\n                            value={totals.totaldiem}\r\n                            type=\"currency\"\r\n                            className={classes.textField}\r\n                            InputLabelProps={{\r\n                              shrink: true,\r\n                            }}\r\n                          ></TextField>\r\n\r\n                          <TextField\r\n                            label=\"No of Days\"\r\n                            variant=\"filled\"\r\n                            style={{ width: \"100%\" }}\r\n                            name=\"totaldays\"\r\n                            value={totals.totaldays}\r\n                            type=\"numeric\"\r\n                            className={classes.textField}\r\n                            InputLabelProps={{\r\n                              shrink: true,\r\n                            }}\r\n                          ></TextField>\r\n                          <TextField\r\n                            label=\"Total Amount\"\r\n                            variant=\"filled\"\r\n                            style={{ width: \"100%\" }}\r\n                            name=\"totalamount\"\r\n                            value={totals.totalamount}\r\n                            type=\"currency\"\r\n                            className={classes.textField}\r\n                            InputLabelProps={{\r\n                              shrink: true,\r\n                            }}\r\n                          ></TextField>\r\n                        </div>\r\n                      </Grid>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ),\r\n            }}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    padding: 0,\r\n    width: 1500,\r\n  },\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n}));\r\n"]},"metadata":{},"sourceType":"module"}