{"ast":null,"code":"import _objectSpread from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _slicedToArray from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useHistory}from\"react-router-dom\";import MaterialTable,{MTableToolbar}from\"material-table\";import{makeStyles}from\"@material-ui/core/styles\";import{TextField,Icon,Button,MenuItem}from\"@material-ui/core\";import{Alert}from\"@material-ui/lab\";import{useSetRecoilState,useRecoilValue,useRecoilState}from\"recoil\";import{allowsPeriodState,allowsDataState,allowsDataDetlsState,allowsDataIdState,empidState,loginLevelState}from\"./data/atomdata\";import AddIcon from\"@material-ui/icons/Add\";import EditIcon from\"@material-ui/icons/Edit\";import DeleteIcon from\"@material-ui/icons/Delete\";import CheckIcon from\"@material-ui/icons/Check\";import SearchIcon from\"@material-ui/icons/Search\";import{CustomDialog}from\"../helpers/CustomDialog\";import{useDailyAllowancesContext}from\"../context/dailyallowances_context\";import DailyAllowancesAddPeriod from\"./DailyAllowancesAddPeriod\";import DailyAllowsDetlsTableStaff from\"./DailyAllowsDetlsTableStaff\";import{useDailyAllows}from\"./dailyallows/useDailyAllows\";import{useAddDailyAllows}from\"./dailyallows/useAddDailyAllows\";import{useUpdateDailyAllows}from\"./dailyallows/useUpdateDailyAllows\";import{useDeleteDailyAllows}from\"./dailyallows/useDeleteDailyAllows\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function DailyAllowancesTableStaff(){var history=useHistory();var classes=useStyles();var _useDailyAllows=useDailyAllows(),dailyallows=_useDailyAllows.dailyallows,setFilter=_useDailyAllows.setFilter;var addDailyAllows=useAddDailyAllows();var updateDailyAllows=useUpdateDailyAllows();var deleteDailyAllows=useDeleteDailyAllows();var _useRecoilState=useRecoilState(loginLevelState),_useRecoilState2=_slicedToArray(_useRecoilState,2),loginLevel=_useRecoilState2[0],setLoginLevel=_useRecoilState2[1];var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isAddPeriodDialogOpen=_useState2[0],setIsAddPeriodDialogOpen=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),tmpallowsdata=_useState4[0],setTmpallowsdata=_useState4[1];var _useRecoilState3=useRecoilState(allowsDataState),_useRecoilState4=_slicedToArray(_useRecoilState3,2),allowsdata=_useRecoilState4[0],setAllowsdata=_useRecoilState4[1];var _useRecoilState5=useRecoilState(allowsDataDetlsState),_useRecoilState6=_slicedToArray(_useRecoilState5,2),allowsDetlsdata=_useRecoilState6[0],setAllowsDetlsdata=_useRecoilState6[1];var _useRecoilState7=useRecoilState(allowsPeriodState),_useRecoilState8=_slicedToArray(_useRecoilState7,2),allows_period=_useRecoilState8[0],setAllows_period=_useRecoilState8[1];var _useRecoilState9=useRecoilState(empidState),_useRecoilState10=_slicedToArray(_useRecoilState9,2),allows_empid=_useRecoilState10[0],setAllows_empid=_useRecoilState10[1];var _useState5=useState(allowsDataIdState),_useState6=_slicedToArray(_useState5,2),allowsdataId=_useState6[0],setAllowsdataId=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),toLoad=_useState8[0],settoLoad=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],setError=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isAllowsDetlDialogOpen=_useState12[0],setIsAllowsDetlDialogOpen=_useState12[1];var title=\"Site Allowances\";var _useDailyAllowancesCo=useDailyAllowancesContext(),dailyallowances=_useDailyAllowancesCo.dailyallowances,dailyallowsdetls=_useDailyAllowancesCo.dailyallowsdetls,loadEmpDailyAllowances=_useDailyAllowancesCo.loadEmpDailyAllowances,loadEmpDailyAllowsDetls=_useDailyAllowancesCo.loadEmpDailyAllowsDetls,dailyallowances_loading=_useDailyAllowancesCo.dailyallowances_loading,dailyallowances_error=_useDailyAllowancesCo.dailyallowances_error,updateDailyAllowance=_useDailyAllowancesCo.updateDailyAllowance,getSingleBatchDailyAllowsDetl=_useDailyAllowancesCo.getSingleBatchDailyAllowsDetl;// useEffect(() => {\n//   loadEmpDailyAllowances(loginLevel.loginUserId);\n// }, [toLoad]);\n// const myCustomSortingAlgorithm = {\n//   ascending: (a, b) => a.period.length - b.period.length,\n//   descending: (a, b) => b.period.length - a.period.length,\n// };\nvar columns=[{title:\"Name\",field:\"name\",editable:\"never\"},{title:\"Period\",field:\"period\",editable:\"never\"},{title:\"Location\",field:\"location\",editable:\"never\"},{title:\"Manager Name\",field:\"manager\",editable:\"never\"},{title:\"No Of Days\",field:\"no_of_days\",type:\"numeric\",editable:\"never\"},{title:\"Amount\",field:\"amount\",type:\"currency\",editable:\"never\"}// {\n//   title: \"Status\",\n//   field: \"status\",\n//   editComponent: (props) => (\n//     <TextField\n//       //defaultValue={props.value || null}\n//       onChange={(e) => props.onChange(e.target.value)}\n//       style={{ width: 100 }}\n//       value={props.value}\n//       select\n//     >\n//       <MenuItem value=\"Pending\">Pending</MenuItem>\n//       {/* <MenuItem value=\"Approve\">Approve</MenuItem>\n//     <MenuItem value=\"Reject\">Reject</MenuItem>\n//     <MenuItem value=\"Cancel\">Cancel</MenuItem> */}\n//     </TextField>\n//   ),\n// },\n];var Save_DailyAllowancesData=function Save_DailyAllowancesData(){dailyallowances.forEach(function(data){var id=data.id;if(id){var _id=data.id,rec_id=data.rec_id,tableData=data.tableData,fields=_objectWithoutProperties(data,[\"id\",\"rec_id\",\"tableData\"]);updateDailyAllowance(_objectSpread({id:_id},fields));}});//handleDialogClose();\n};var update_SiteAllowsDetl=function update_SiteAllowsDetl(data){var id=data.id,empid=data.empid,period=data.period,no_of_days=data.no_of_days,amount=data.amount;loadEmpDailyAllowsDetls(empid,period);setAllows_period(period);setAllows_empid(empid);setAllowsdataId(id);setAllows_period(period);setAllows_empid(empid);setAllowsdataId(id);setAllowsdata(_objectSpread(_objectSpread({},allowsdata),{},{id:id,no_of_days:no_of_days,amount:amount,period:period,empid:empid}));//setIsAllowsDetlDialogOpen(true);\nhistory.push(\"/singledailyallowsdetlstable\");};var add_SiteAllowsPeriod=function add_SiteAllowsPeriod(){handleAddPeriodDialogOpen();};var handleAddPeriodDialogOpen=function handleAddPeriodDialogOpen(){setIsAddPeriodDialogOpen(true);};var handleAddPeriodDialogClose=function handleAddPeriodDialogClose(){setIsAddPeriodDialogOpen(false);};var handleAllowsDetlDialogOpen=function handleAllowsDetlDialogOpen(){setIsAllowsDetlDialogOpen(true);};var handleAllowsDetlDialogClose=function handleAllowsDetlDialogClose(){settoLoad(true);setIsAllowsDetlDialogOpen(false);};useEffect(function(){setFilter(loginLevel.loginUserId);},[]);return/*#__PURE__*/_jsx(\"div\",{className:classes.root,children:/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:\"100%\",paddingTop:\"5px\"},children:[/*#__PURE__*/_jsx(MaterialTable,{columns:columns,data:dailyallows,title:title,icons:{Add:function Add(props){return/*#__PURE__*/_jsx(AddIcon,{});},Edit:function Edit(props){return/*#__PURE__*/_jsx(EditIcon,{});},Delete:function Delete(props){return/*#__PURE__*/_jsx(DeleteIcon,{});},Clear:function Clear(props){return/*#__PURE__*/_jsx(DeleteIcon,{});},Check:function Check(props){return/*#__PURE__*/_jsx(CheckIcon,{});},Search:function Search(props){return/*#__PURE__*/_jsx(SearchIcon,{});},ResetSearch:function ResetSearch(props){return/*#__PURE__*/_jsx(DeleteIcon,{});}}// editable={{\n//   onRowUpdate: (newData, oldData) =>\n//     new Promise((resolve, reject) => {\n//       setTimeout(() => {\n//         // const dataUpdate = [...dailyallowances];\n//         // const index = oldData.tableData.id;\n//         // dataUpdate[index] = newData;\n//         //setDailyAllowances([...dataUpdate]);\n//         //approve_Expense(newData);\n//         update_AllowsDetl();\n//         resolve();\n//       }, 1000);\n//     }),\n// }}\n,actions:[{icon:\"add\",tooltip:\"Add Record\",isFreeAction:true,onClick:function onClick(event,rowData){add_SiteAllowsPeriod();}},function(rowData){return{disabled:rowData.status!==\"Pending\",icon:\"edit\",tooltip:\"Edit Record\",onClick:function onClick(event,rowData){update_SiteAllowsDetl(rowData);}};}],options:{filtering:true,sorting:true,headerStyle:{backgroundColor:\"orange\",color:\"#FFF\"},showTitle:true},components:{Toolbar:function Toolbar(props){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(MTableToolbar,_objectSpread({},props)),/*#__PURE__*/_jsx(\"div\",{style:{padding:\"5px 10px\"},children:error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",onClose:function onClose(){return setError(false);},children:\"Period already existed!\"})})]});}}}),/*#__PURE__*/_jsx(\"div\",{className:classes.dialog,children:/*#__PURE__*/_jsx(CustomDialog,{isOpen:isAddPeriodDialogOpen,handleClose:handleAddPeriodDialogClose,title:\"\",showButton:true,isFullscreen:false,isFullwidth:false,children:/*#__PURE__*/_jsx(DailyAllowancesAddPeriod,{handleDialogClose:handleAddPeriodDialogClose})})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(CustomDialog,{isOpen:isAllowsDetlDialogOpen,handleClose:handleAllowsDetlDialogClose,title:\"\",showButton:true,isFullscreen:false,isFullwidth:false,children:/*#__PURE__*/_jsx(DailyAllowsDetlsTableStaff,{allowsdata:allowsdata,allowsdataId:allowsdataId,handleDialogClose:handleAllowsDetlDialogClose})})})]})});}var useStyles=makeStyles(function(theme){return{root:{padding:0},dialog:{width:1000}};});","map":{"version":3,"sources":["D:/react-myprojects/hrms-airtable-july2/src/components/DailyAllowancesTableStaff.js"],"names":["React","useState","useEffect","useHistory","MaterialTable","MTableToolbar","makeStyles","TextField","Icon","Button","MenuItem","Alert","useSetRecoilState","useRecoilValue","useRecoilState","allowsPeriodState","allowsDataState","allowsDataDetlsState","allowsDataIdState","empidState","loginLevelState","AddIcon","EditIcon","DeleteIcon","CheckIcon","SearchIcon","CustomDialog","useDailyAllowancesContext","DailyAllowancesAddPeriod","DailyAllowsDetlsTableStaff","useDailyAllows","useAddDailyAllows","useUpdateDailyAllows","useDeleteDailyAllows","DailyAllowancesTableStaff","history","classes","useStyles","dailyallows","setFilter","addDailyAllows","updateDailyAllows","deleteDailyAllows","loginLevel","setLoginLevel","isAddPeriodDialogOpen","setIsAddPeriodDialogOpen","tmpallowsdata","setTmpallowsdata","allowsdata","setAllowsdata","allowsDetlsdata","setAllowsDetlsdata","allows_period","setAllows_period","allows_empid","setAllows_empid","allowsdataId","setAllowsdataId","toLoad","settoLoad","error","setError","isAllowsDetlDialogOpen","setIsAllowsDetlDialogOpen","title","dailyallowances","dailyallowsdetls","loadEmpDailyAllowances","loadEmpDailyAllowsDetls","dailyallowances_loading","dailyallowances_error","updateDailyAllowance","getSingleBatchDailyAllowsDetl","columns","field","editable","type","Save_DailyAllowancesData","forEach","data","id","rec_id","tableData","fields","update_SiteAllowsDetl","empid","period","no_of_days","amount","push","add_SiteAllowsPeriod","handleAddPeriodDialogOpen","handleAddPeriodDialogClose","handleAllowsDetlDialogOpen","handleAllowsDetlDialogClose","loginUserId","root","maxWidth","paddingTop","Add","props","Edit","Delete","Clear","Check","Search","ResetSearch","icon","tooltip","isFreeAction","onClick","event","rowData","disabled","status","filtering","sorting","headerStyle","backgroundColor","color","showTitle","Toolbar","padding","dialog","theme","width"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport MaterialTable, { MTableToolbar } from \"material-table\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { TextField, Icon, Button, MenuItem } from \"@material-ui/core\";\r\nimport { Alert } from \"@material-ui/lab\";\r\nimport { useSetRecoilState, useRecoilValue, useRecoilState } from \"recoil\";\r\nimport {\r\n  allowsPeriodState,\r\n  allowsDataState,\r\n  allowsDataDetlsState,\r\n  allowsDataIdState,\r\n  empidState,\r\n  loginLevelState,\r\n} from \"./data/atomdata\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport CheckIcon from \"@material-ui/icons/Check\";\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport { CustomDialog } from \"../helpers/CustomDialog\";\r\nimport { useDailyAllowancesContext } from \"../context/dailyallowances_context\";\r\nimport DailyAllowancesAddPeriod from \"./DailyAllowancesAddPeriod\";\r\nimport DailyAllowsDetlsTableStaff from \"./DailyAllowsDetlsTableStaff\";\r\nimport { useDailyAllows } from \"./dailyallows/useDailyAllows\"\r\nimport { useAddDailyAllows } from \"./dailyallows/useAddDailyAllows\";\r\nimport { useUpdateDailyAllows } from \"./dailyallows/useUpdateDailyAllows\";\r\nimport { useDeleteDailyAllows } from \"./dailyallows/useDeleteDailyAllows\";\r\n\r\n\r\nexport default function DailyAllowancesTableStaff() {\r\n  let history = useHistory();\r\n  const classes = useStyles();\r\n  const { dailyallows, setFilter } = useDailyAllows()\r\n  const addDailyAllows = useAddDailyAllows();\r\n  const updateDailyAllows = useUpdateDailyAllows();\r\n  const deleteDailyAllows = useDeleteDailyAllows();\r\n  const [loginLevel, setLoginLevel] = useRecoilState(loginLevelState);\r\n  const [isAddPeriodDialogOpen, setIsAddPeriodDialogOpen] = useState(false);\r\n  const [tmpallowsdata, setTmpallowsdata] = useState([]);\r\n  const [allowsdata, setAllowsdata] = useRecoilState(allowsDataState);\r\n  const [allowsDetlsdata, setAllowsDetlsdata] =\r\n    useRecoilState(allowsDataDetlsState);\r\n  const [allows_period, setAllows_period] = useRecoilState(allowsPeriodState);\r\n  const [allows_empid, setAllows_empid] = useRecoilState(empidState);\r\n  const [allowsdataId, setAllowsdataId] = useState(allowsDataIdState);\r\n  const [toLoad, settoLoad] = useState(true);\r\n  const [error, setError] = useState(\"\");\r\n  const [isAllowsDetlDialogOpen, setIsAllowsDetlDialogOpen] = useState(false);\r\n  const title = `Site Allowances`;\r\n  const {\r\n    dailyallowances,\r\n    dailyallowsdetls,\r\n    loadEmpDailyAllowances,\r\n    loadEmpDailyAllowsDetls,\r\n    dailyallowances_loading,\r\n    dailyallowances_error,\r\n    updateDailyAllowance,\r\n    getSingleBatchDailyAllowsDetl,\r\n  } = useDailyAllowancesContext();\r\n\r\n  // useEffect(() => {\r\n  //   loadEmpDailyAllowances(loginLevel.loginUserId);\r\n  // }, [toLoad]);\r\n\r\n  // const myCustomSortingAlgorithm = {\r\n  //   ascending: (a, b) => a.period.length - b.period.length,\r\n  //   descending: (a, b) => b.period.length - a.period.length,\r\n  // };\r\n\r\n  const columns = [\r\n    {\r\n      title: \"Name\",\r\n      field: \"name\",\r\n      editable: \"never\",\r\n    },\r\n    {\r\n      title: \"Period\",\r\n      field: \"period\",\r\n      editable: \"never\",\r\n    },\r\n    { title: \"Location\", field: \"location\", editable: \"never\" },\r\n    { title: \"Manager Name\", field: \"manager\", editable: \"never\" },\r\n    {\r\n      title: \"No Of Days\",\r\n      field: \"no_of_days\",\r\n      type: \"numeric\",\r\n      editable: \"never\",\r\n    },\r\n    { title: \"Amount\", field: \"amount\", type: \"currency\", editable: \"never\" },\r\n    // {\r\n    //   title: \"Status\",\r\n    //   field: \"status\",\r\n    //   editComponent: (props) => (\r\n    //     <TextField\r\n    //       //defaultValue={props.value || null}\r\n    //       onChange={(e) => props.onChange(e.target.value)}\r\n    //       style={{ width: 100 }}\r\n    //       value={props.value}\r\n    //       select\r\n    //     >\r\n    //       <MenuItem value=\"Pending\">Pending</MenuItem>\r\n    //       {/* <MenuItem value=\"Approve\">Approve</MenuItem>\r\n    //     <MenuItem value=\"Reject\">Reject</MenuItem>\r\n    //     <MenuItem value=\"Cancel\">Cancel</MenuItem> */}\r\n    //     </TextField>\r\n    //   ),\r\n    // },\r\n  ];\r\n\r\n  const Save_DailyAllowancesData = () => {\r\n    dailyallowances.forEach((data) => {\r\n      const { id } = data;\r\n      if (id) {\r\n        const { id, rec_id, tableData, ...fields } = data;\r\n        updateDailyAllowance({ id, ...fields });\r\n      }\r\n    });\r\n\r\n    //handleDialogClose();\r\n  };\r\n\r\n  const update_SiteAllowsDetl = (data) => {\r\n    const { id, empid, period, no_of_days, amount } = data;\r\n\r\n    loadEmpDailyAllowsDetls(empid, period);\r\n   \r\n    setAllows_period(period);\r\n    setAllows_empid(empid);\r\n    setAllowsdataId(id);\r\n    setAllows_period(period);\r\n    setAllows_empid(empid);\r\n    setAllowsdataId(id);\r\n    setAllowsdata({\r\n      ...allowsdata,\r\n      id: id,\r\n      no_of_days: no_of_days,\r\n      amount: amount,\r\n      period: period,\r\n      empid: empid,\r\n    });\r\n\r\n    //setIsAllowsDetlDialogOpen(true);\r\n    history.push(\"/singledailyallowsdetlstable\");\r\n  };\r\n\r\n  const add_SiteAllowsPeriod = () => {\r\n    handleAddPeriodDialogOpen();\r\n  };\r\n\r\n  const handleAddPeriodDialogOpen = () => {\r\n    setIsAddPeriodDialogOpen(true);\r\n  };\r\n\r\n  const handleAddPeriodDialogClose = () => {\r\n    setIsAddPeriodDialogOpen(false);\r\n  };\r\n\r\n  const handleAllowsDetlDialogOpen = () => {\r\n    setIsAllowsDetlDialogOpen(true);\r\n  };\r\n\r\n  const handleAllowsDetlDialogClose = () => {\r\n    settoLoad(true);\r\n    setIsAllowsDetlDialogOpen(false);\r\n  };\r\n\r\n  \r\n  useEffect(() => {\r\n    setFilter(loginLevel.loginUserId);\r\n  }, []);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <div style={{ maxWidth: \"100%\", paddingTop: \"5px\" }}>\r\n        <MaterialTable\r\n          columns={columns}\r\n          data={dailyallows}\r\n          title={title}\r\n          icons={{\r\n            Add: (props) => <AddIcon />,\r\n            Edit: (props) => <EditIcon />,\r\n            Delete: (props) => <DeleteIcon />,\r\n            Clear: (props) => <DeleteIcon />,\r\n            Check: (props) => <CheckIcon />,\r\n            Search: (props) => <SearchIcon />,\r\n            ResetSearch: (props) => <DeleteIcon />,\r\n          }}\r\n          // editable={{\r\n          //   onRowUpdate: (newData, oldData) =>\r\n          //     new Promise((resolve, reject) => {\r\n          //       setTimeout(() => {\r\n          //         // const dataUpdate = [...dailyallowances];\r\n          //         // const index = oldData.tableData.id;\r\n          //         // dataUpdate[index] = newData;\r\n          //         //setDailyAllowances([...dataUpdate]);\r\n          //         //approve_Expense(newData);\r\n          //         update_AllowsDetl();\r\n          //         resolve();\r\n          //       }, 1000);\r\n          //     }),\r\n          // }}\r\n          actions={[\r\n            {\r\n              icon: \"add\",\r\n              tooltip: \"Add Record\",\r\n              isFreeAction: true,\r\n              onClick: (event, rowData) => {\r\n                add_SiteAllowsPeriod();\r\n              },\r\n            },\r\n            (rowData) => ({\r\n              disabled: rowData.status !== \"Pending\",\r\n              icon: \"edit\",\r\n              tooltip: \"Edit Record\",\r\n              onClick: (event, rowData) => {\r\n                update_SiteAllowsDetl(rowData);\r\n              },\r\n            }),\r\n          ]}\r\n          options={{\r\n            filtering: true,\r\n            sorting: true,\r\n            headerStyle: {\r\n              backgroundColor: \"orange\",\r\n              color: \"#FFF\",\r\n            },\r\n            showTitle: true,\r\n          }}\r\n          components={{\r\n            Toolbar: (props) => (\r\n              <div>\r\n                <MTableToolbar {...props} />\r\n\r\n                <div style={{ padding: \"5px 10px\" }}>\r\n                  {error && (\r\n                    <Alert severity=\"error\" onClose={() => setError(false)}>\r\n                      Period already existed!\r\n                    </Alert>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ),\r\n          }}\r\n        />\r\n        <div className={classes.dialog}>\r\n          <CustomDialog\r\n            isOpen={isAddPeriodDialogOpen}\r\n            handleClose={handleAddPeriodDialogClose}\r\n            title=\"\"\r\n            showButton={true}\r\n            isFullscreen={false}\r\n            isFullwidth={false}\r\n          >\r\n            <DailyAllowancesAddPeriod\r\n              handleDialogClose={handleAddPeriodDialogClose}\r\n            />\r\n          </CustomDialog>\r\n        </div>\r\n        <div>\r\n          <CustomDialog\r\n            isOpen={isAllowsDetlDialogOpen}\r\n            handleClose={handleAllowsDetlDialogClose}\r\n            title=\"\"\r\n            showButton={true}\r\n            isFullscreen={false}\r\n            isFullwidth={false}\r\n          >\r\n            <DailyAllowsDetlsTableStaff\r\n              allowsdata={allowsdata}\r\n              allowsdataId={allowsdataId}\r\n              handleDialogClose={handleAllowsDetlDialogClose}\r\n            />\r\n          </CustomDialog>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    padding: 0,\r\n  },\r\n  dialog: {\r\n    width: 1000,\r\n  },\r\n}));\r\n"]},"metadata":{},"sourceType":"module"}