{"ast":null,"code":"import _objectSpread from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{Button,ButtonGroup,TextField}from\"@material-ui/core\";import{makeStyles}from\"@material-ui/core/styles\";import{useEmployees}from\"./employees/useEmployees\";import{useRecoilState}from\"recoil\";import{loginLevelState}from\"./data/atomdata\";import{useEmployeesContext}from\"../context/employees_context\";import{setStoredUser}from\"./user-storage\";import{useUser}from\"./user/useUser\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SigninForm=function SigninForm(){var classes=useStyles();var _useUser=useUser(),user=_useUser.user;var _useEmployees=useEmployees(),employees=_useEmployees.employees;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),role=_useState6[0],setRole=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),alert=_useState8[0],setAlert=_useState8[1];//const [isLoading, setIsLoading] = useState(false);\nconsole.log(\"user\",user);var _useRecoilState=useRecoilState(loginLevelState),_useRecoilState2=_slicedToArray(_useRecoilState,2),loginLevel=_useRecoilState2[0],setLoginLevel=_useRecoilState2[1];var _useEmployeesContext=useEmployeesContext(),loadEmployees=_useEmployeesContext.loadEmployees,setEditEmployeeID=_useEmployeesContext.setEditEmployeeID,employees_loading=_useEmployeesContext.employees_loading,employees_error=_useEmployeesContext.employees_error;// useEffect(() => {\n//   loadEmployees();\n// }, []);\nvar handleSubmit=function handleSubmit(e){e.preventDefault();var emp=employees.filter(function(item){return item.email===email;}).map(function(row){return{id:row.id,name:row.name,email:row.email,password:row.password,role:role,leave_bal:row.leave_bal,siteallows_fee:row.siteallows_fee,perdiem_fee:row.perdiem_fee,reporting_to:row.reporting_to};});console.log(\"emp\",emp);if(emp[0].email===email&&emp[0].password===password){setLoginLevel(_objectSpread(_objectSpread({},loginLevel),{},{loginUser:emp[0].name,loginUserId:emp[0].id,loginLevel:role,loginEmail:email,login:true,leave_bal:emp[0].leave_bal,siteallows_fee:emp[0].siteallows_fee,perdiem_fee:emp[0].perdiem_fee,reporting_to:emp[0].reporting_to}));setEditEmployeeID(emp[0].id);setPassword(\"\");setStoredUser(emp[0]);console.log(\"save user\",loginLevel);}else{setAlert(false);setTimeout(function(){setAlert(true);},2000);}};var handleStaffClick=function handleStaffClick(e){console.log(\"Staff\");e.preventDefault();setRole(\"Staff\");handleSubmit(e);};var handleAdminClick=function handleAdminClick(e){e.preventDefault();setRole(\"Admin\");handleSubmit(e);};var handleAdminManagerClick=function handleAdminManagerClick(e){e.preventDefault();setRole(\"AdminManager\");handleSubmit(e);};var handleManagerClick=function handleManagerClick(e){e.preventDefault();setRole(\"Manager\");handleSubmit(e);};return/*#__PURE__*/_jsxs(\"form\",{className:classes.root,onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:\"center\"},children:[/*#__PURE__*/_jsx(TextField,{label:\"Email\",variant:\"filled\",type:\"email\",required:true,style:{width:350},value:email,onChange:function onChange(e){return setEmail(e.target.value);}}),/*#__PURE__*/_jsx(TextField,{label:\"Password\",variant:\"filled\",type:\"password\",style:{width:350},required:true,value:password,onChange:function onChange(e){return setPassword(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:\"center\"},children:[/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",className:classes.button,onClick:function onClick(e){return setRole(\"Staff\");},children:\"Staff\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",className:classes.button,onClick:function onClick(e){return setRole(\"Admin\");},children:\"Admin\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",className:classes.button,onClick:function onClick(e){return setRole(\"AdminManager\");},children:\"Admin Manager\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",className:classes.button,onClick:function onClick(e){return setRole(\"Manager\");},children:\"Manager\"})]}),!alert&&/*#__PURE__*/_jsx(\"h3\",{children:\"Login Fail!\"})]});};var useStyles=makeStyles(function(theme){return{root:{display:\"flex\",flexDirection:\"column\",justifyContent:\"center\",alignItems:\"center\",padding:theme.spacing(2),\"& .MuiTextField-root\":{margin:theme.spacing(1),width:\"600px\"},\"& .MuiButtonBase-root\":{margin:theme.spacing(2)}}};});export default SigninForm;","map":{"version":3,"sources":["D:/react-myprojects/hrms-airtable-july2/src/components/SigninForm.js"],"names":["React","useState","useEffect","Button","ButtonGroup","TextField","makeStyles","useEmployees","useRecoilState","loginLevelState","useEmployeesContext","setStoredUser","useUser","SigninForm","classes","useStyles","user","employees","email","setEmail","password","setPassword","role","setRole","alert","setAlert","console","log","loginLevel","setLoginLevel","loadEmployees","setEditEmployeeID","employees_loading","employees_error","handleSubmit","e","preventDefault","emp","filter","item","map","row","id","name","leave_bal","siteallows_fee","perdiem_fee","reporting_to","loginUser","loginUserId","loginEmail","login","setTimeout","handleStaffClick","handleAdminClick","handleAdminManagerClick","handleManagerClick","root","textAlign","width","target","value","button","theme","display","flexDirection","justifyContent","alignItems","padding","spacing","margin"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Button, ButtonGroup, TextField } from \"@material-ui/core\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { useEmployees } from \"./employees/useEmployees\";\r\nimport { useRecoilState } from \"recoil\";\r\nimport { loginLevelState } from \"./data/atomdata\";\r\nimport { useEmployeesContext } from \"../context/employees_context\";\r\nimport { setStoredUser } from \"./user-storage\";\r\nimport { useUser } from \"./user/useUser\";\r\n\r\nconst SigninForm = () => {\r\n  const classes = useStyles();\r\n  const { user } = useUser();\r\n  const { employees } = useEmployees();\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [role, setRole] = useState(\"\");\r\n  const [alert, setAlert] = useState(true);\r\n  //const [isLoading, setIsLoading] = useState(false);\r\n  console.log(\"user\", user);\r\n  const [loginLevel, setLoginLevel] = useRecoilState(loginLevelState);\r\n  const {\r\n    loadEmployees,\r\n    setEditEmployeeID,\r\n    employees_loading,\r\n    employees_error,\r\n  } = useEmployeesContext();\r\n\r\n  // useEffect(() => {\r\n  //   loadEmployees();\r\n  // }, []);\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n\r\n    const emp = employees\r\n      .filter((item) => item.email === email)\r\n      .map((row) => {\r\n        return {\r\n          id: row.id,\r\n          name: row.name,\r\n          email: row.email,\r\n          password: row.password,\r\n          role: role,\r\n          leave_bal: row.leave_bal,\r\n          siteallows_fee: row.siteallows_fee,\r\n          perdiem_fee: row.perdiem_fee,\r\n          reporting_to: row.reporting_to,\r\n        };\r\n      });\r\n    console.log(\"emp\", emp);\r\n    if (emp[0].email === email && emp[0].password === password) {\r\n      setLoginLevel({\r\n        ...loginLevel,\r\n        loginUser: emp[0].name,\r\n        loginUserId: emp[0].id,\r\n        loginLevel: role,\r\n        loginEmail: email,\r\n        login: true,\r\n        leave_bal: emp[0].leave_bal,\r\n        siteallows_fee: emp[0].siteallows_fee,\r\n        perdiem_fee: emp[0].perdiem_fee,\r\n        reporting_to: emp[0].reporting_to,\r\n      });\r\n      setEditEmployeeID(emp[0].id);\r\n      setPassword(\"\");\r\n      setStoredUser(emp[0]);\r\n\r\n      console.log(\"save user\", loginLevel);\r\n    } else {\r\n      setAlert(false);\r\n      setTimeout(() => {\r\n        setAlert(true);\r\n      }, 2000);\r\n    }\r\n  };\r\n\r\n  const handleStaffClick = (e) => {\r\n    console.log(\"Staff\");\r\n    e.preventDefault();\r\n    setRole(\"Staff\");\r\n    handleSubmit(e);\r\n  };\r\n  const handleAdminClick = (e) => {\r\n    e.preventDefault();\r\n    setRole(\"Admin\");\r\n    handleSubmit(e);\r\n  };\r\n  const handleAdminManagerClick = (e) => {\r\n    e.preventDefault();\r\n    setRole(\"AdminManager\");\r\n    handleSubmit(e);\r\n  };\r\n  const handleManagerClick = (e) => {\r\n    e.preventDefault();\r\n    setRole(\"Manager\");\r\n    handleSubmit(e);\r\n  };\r\n\r\n  return (\r\n    <form className={classes.root} onSubmit={handleSubmit}>\r\n      <div style={{ textAlign: \"center\" }}>\r\n        <TextField\r\n          label=\"Email\"\r\n          variant=\"filled\"\r\n          type=\"email\"\r\n          required\r\n          style={{ width: 350 }}\r\n          value={email}\r\n          onChange={(e) => setEmail(e.target.value)}\r\n        />\r\n        <TextField\r\n          label=\"Password\"\r\n          variant=\"filled\"\r\n          type=\"password\"\r\n          style={{ width: 350 }}\r\n          required\r\n          value={password}\r\n          onChange={(e) => setPassword(e.target.value)}\r\n        />\r\n      </div>\r\n\r\n      <div style={{ textAlign: \"center\" }}>\r\n        {/* <ButtonGroup> */}\r\n        <Button\r\n          type=\"submit\"\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          className={classes.button}\r\n          onClick={(e) => setRole(\"Staff\")}\r\n        >\r\n          Staff\r\n        </Button>\r\n        <Button\r\n          type=\"submit\"\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          className={classes.button}\r\n          onClick={(e) => setRole(\"Admin\")}\r\n        >\r\n          Admin\r\n        </Button>\r\n        <Button\r\n          type=\"submit\"\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          className={classes.button}\r\n          onClick={(e) => setRole(\"AdminManager\")}\r\n        >\r\n          Admin Manager\r\n        </Button>\r\n        <Button\r\n          type=\"submit\"\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          className={classes.button}\r\n          onClick={(e) => setRole(\"Manager\")}\r\n        >\r\n          Manager\r\n        </Button>\r\n        {/* </ButtonGroup> */}\r\n      </div>\r\n      {!alert && <h3>Login Fail!</h3>}\r\n    </form>\r\n  );\r\n};\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    padding: theme.spacing(2),\r\n\r\n    \"& .MuiTextField-root\": {\r\n      margin: theme.spacing(1),\r\n      width: \"600px\",\r\n    },\r\n    \"& .MuiButtonBase-root\": {\r\n      margin: theme.spacing(2),\r\n    },\r\n  },\r\n}));\r\n\r\nexport default SigninForm;\r\n"]},"metadata":{},"sourceType":"module"}