{"ast":null,"code":"import _objectSpread from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _slicedToArray from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useHistory,Link}from\"react-router-dom\";import MaterialTable,{MTableToolbar}from\"material-table\";import{makeStyles}from\"@material-ui/core/styles\";import{TextField,Icon,Button,MenuItem}from\"@material-ui/core\";import{useSetRecoilState,useRecoilValue,useRecoilState,useRecoilValueLoadable}from\"recoil\";import{allowsPeriodState,allowsDataState,empidState}from\"./data/atomdata\";import{fetchDailyAllowancesSelector}from\"./data/selectordata\";import AddIcon from\"@material-ui/icons/Add\";import EditIcon from\"@material-ui/icons/Edit\";import DeleteIcon from\"@material-ui/icons/Delete\";import CheckIcon from\"@material-ui/icons/Check\";import SearchIcon from\"@material-ui/icons/Search\";import ArrowBackIcon from\"@material-ui/icons/ArrowBack\";import{CustomDialog}from\"../helpers/CustomDialog\";import{useDailyAllowancesContext}from\"../context/dailyallowances_context\";//import { useEmployeesContext } from \"../context/employees_context\";\nimport DailyAllowsDetlsTable from\"./DailyAllowsDetlsTable\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var FILTERSTRING=\"Pending\";var columns=[{title:\"Name\",field:\"name\",editable:\"never\"},{title:\"Period\",field:\"period\",editable:\"never\"},{title:\"Location\",field:\"location\",editable:\"never\"},{title:\"Manager Name\",field:\"manager\",editable:\"never\"},{title:\"No Of Days\",field:\"no_of_days\",type:\"numeric\",editable:\"never\"},{title:\"Amount\",field:\"amount\",type:\"currency\",editable:\"never\"},{title:\"Status\",field:\"status\",editComponent:function editComponent(props){return/*#__PURE__*/_jsxs(TextField//defaultValue={props.value || null}\n,{onChange:function onChange(e){return props.onChange(e.target.value);},style:{width:100},value:props.value,select:true,children:[/*#__PURE__*/_jsx(MenuItem,{value:\"Pending\",children:\"Pending\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"Approve\",children:\"Approve\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"Reject\",children:\"Reject\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"Cancel\",children:\"Cancel\"})]});}}];export default function DailyAllowancesTable(_ref){var dailyallowancesdata=_ref.dailyallowancesdata,setDailyAllowancesdata=_ref.setDailyAllowancesdata,update_dailyallowance_error=_ref.update_dailyallowance_error,handleDialogClose=_ref.handleDialogClose;var history=useHistory();var classes=useStyles();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isDialogOpen=_useState2[0],setIsDialogOpen=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),tmpallowsdata=_useState4[0],setTmpallowsdata=_useState4[1];var allows_period=useRecoilValue(allowsPeriodState);var allows_empid=useRecoilValue(empidState);var _useRecoilState=useRecoilState(allowsDataState),_useRecoilState2=_slicedToArray(_useRecoilState,2),allowsdata=_useRecoilState2[0],setAllowsdata=_useRecoilState2[1];var setEmpID=useSetRecoilState(empidState);var title=\"Site Allowances (\".concat(allows_period,\")\");var _useDailyAllowancesCo=useDailyAllowancesContext(),dailyallowances_loading=_useDailyAllowancesCo.dailyallowances_loading,singlebatch_dailyallowance=_useDailyAllowancesCo.singlebatch_dailyallowance,singlebatch_dailyallowance_loading=_useDailyAllowancesCo.singlebatch_dailyallowance_loading,deleteDailyAllowance=_useDailyAllowancesCo.deleteDailyAllowance,updateDailyAllowance=_useDailyAllowancesCo.updateDailyAllowance,setEditDailyAllowanceID=_useDailyAllowancesCo.setEditDailyAllowanceID,setIsDailyAllowanceEditingOn=_useDailyAllowancesCo.setIsDailyAllowanceEditingOn,setIsDailyAllowanceEditingOff=_useDailyAllowancesCo.setIsDailyAllowanceEditingOff,resetSingleDailyAllowance=_useDailyAllowancesCo.resetSingleDailyAllowance,dailyallowance_period=_useDailyAllowancesCo.dailyallowance_period,getSingleBatchDailyAllowance=_useDailyAllowancesCo.getSingleBatchDailyAllowance;var Save_DailyAllowancesData=function Save_DailyAllowancesData(){dailyallowancesdata.forEach(function(data){var id=data.id;if(id){var _id=data.id,rec_id=data.rec_id,tableData=data.tableData,fields=_objectWithoutProperties(data,[\"id\",\"rec_id\",\"tableData\"]);updateDailyAllowance(_objectSpread({id:_id},fields));}});handleDialogClose();};var Approve_DailyAllowancesData=function Approve_DailyAllowancesData(){dailyallowancesdata.forEach(function(rec){if(rec.tableData.checked){updateDailyAllowance({id:rec.id,status:\"Approve\"});//update leavesdata\nif(!update_dailyallowance_error){var recdata=dailyallowancesdata.filter(function(r){return r.id===rec.id;});recdata[0].status=\"Approve\";}}});dailyallowancesdata.forEach(function(d){if(d.tableData)d.tableData.checked=false;});};var Reject_DailyAllowancesData=function Reject_DailyAllowancesData(){dailyallowancesdata.forEach(function(rec){if(rec.tableData.checked){updateDailyAllowance({id:rec.id,status:\"Reject\"});//update leavesdata\nif(!update_dailyallowance_error){var recdata=dailyallowancesdata.filter(function(r){return r.id===rec.id;});recdata[0].status=\"Reject\";}}});dailyallowancesdata.forEach(function(d){if(d.tableData)d.tableData.checked=false;});};if(dailyallowances_loading){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Loading... daily allowances\"})});}return/*#__PURE__*/_jsx(\"div\",{className:classes.root,children:/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:\"100%\",paddingTop:\"5px\"},children:[/*#__PURE__*/_jsx(MaterialTable,{columns:columns,data:dailyallowancesdata,title:title,icons:{Add:function Add(props){return/*#__PURE__*/_jsx(AddIcon,{});},Edit:function Edit(props){return/*#__PURE__*/_jsx(EditIcon,{});},Delete:function Delete(props){return/*#__PURE__*/_jsx(DeleteIcon,{});},Clear:function Clear(props){return/*#__PURE__*/_jsx(DeleteIcon,{});},Check:function Check(props){return/*#__PURE__*/_jsx(CheckIcon,{});},Search:function Search(props){return/*#__PURE__*/_jsx(SearchIcon,{});},ResetSearch:function ResetSearch(props){return/*#__PURE__*/_jsx(DeleteIcon,{});}}// editable={{\n//   onRowUpdate: (newData, oldData) =>\n//     new Promise((resolve, reject) => {\n//       setTimeout(() => {\n//         const dataUpdate = [...dailyallowancesdata];\n//         const index = oldData.tableData.id;\n//         dataUpdate[index] = newData;\n//         setDailyAllowancesdata([...dataUpdate]);\n//         //approve_Expense(newData);\n//         resolve();\n//       }, 1000);\n//     }),\n// }}\n,options:{filtering:true,selection:true,headerStyle:{backgroundColor:\"orange\",color:\"#FFF\"},showTitle:true},components:{Toolbar:function Toolbar(props){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(MTableToolbar,_objectSpread({},props)),/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"5px 10px\"},children:[/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"secondary\",className:classes.button,onClick:Approve_DailyAllowancesData,children:\"Approve\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"secondary\",className:classes.button,onClick:Reject_DailyAllowancesData,children:\"Reject\"})]})]});}}}),/*#__PURE__*/_jsx(\"div\",{className:classes.dialog,children:/*#__PURE__*/_jsx(CustomDialog,{isOpen:isDialogOpen,handleClose:handleDialogClose,title:\"\",showButton:true,isFullscreen:true,isFullwidth:true,children:/*#__PURE__*/_jsx(DailyAllowsDetlsTable,{setAllowsdata:setAllowsdata,allowsdata:allowsdata,handleDialogClose:handleDialogClose})})})]})});}var useStyles=makeStyles(function(theme){return{root:{padding:0},button:{margin:theme.spacing(1)},dialog:{width:1000}};});","map":{"version":3,"sources":["D:/react-myprojects/hrms-airtable-july2/src/components/DailyAllowancesTableAdmin.js"],"names":["React","useState","useEffect","useHistory","Link","MaterialTable","MTableToolbar","makeStyles","TextField","Icon","Button","MenuItem","useSetRecoilState","useRecoilValue","useRecoilState","useRecoilValueLoadable","allowsPeriodState","allowsDataState","empidState","fetchDailyAllowancesSelector","AddIcon","EditIcon","DeleteIcon","CheckIcon","SearchIcon","ArrowBackIcon","CustomDialog","useDailyAllowancesContext","DailyAllowsDetlsTable","FILTERSTRING","columns","title","field","editable","type","editComponent","props","e","onChange","target","value","width","DailyAllowancesTable","dailyallowancesdata","setDailyAllowancesdata","update_dailyallowance_error","handleDialogClose","history","classes","useStyles","isDialogOpen","setIsDialogOpen","tmpallowsdata","setTmpallowsdata","allows_period","allows_empid","allowsdata","setAllowsdata","setEmpID","dailyallowances_loading","singlebatch_dailyallowance","singlebatch_dailyallowance_loading","deleteDailyAllowance","updateDailyAllowance","setEditDailyAllowanceID","setIsDailyAllowanceEditingOn","setIsDailyAllowanceEditingOff","resetSingleDailyAllowance","dailyallowance_period","getSingleBatchDailyAllowance","Save_DailyAllowancesData","forEach","data","id","rec_id","tableData","fields","Approve_DailyAllowancesData","rec","checked","status","recdata","filter","r","d","Reject_DailyAllowancesData","root","maxWidth","paddingTop","Add","Edit","Delete","Clear","Check","Search","ResetSearch","filtering","selection","headerStyle","backgroundColor","color","showTitle","Toolbar","padding","button","dialog","theme","margin","spacing"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useHistory, Link } from \"react-router-dom\";\r\nimport MaterialTable, { MTableToolbar } from \"material-table\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { TextField, Icon, Button, MenuItem } from \"@material-ui/core\";\r\nimport {\r\n  useSetRecoilState,\r\n  useRecoilValue,\r\n  useRecoilState,\r\n  useRecoilValueLoadable,\r\n} from \"recoil\";\r\nimport {\r\n  allowsPeriodState,\r\n  allowsDataState,\r\n  empidState,\r\n} from \"./data/atomdata\";\r\nimport { fetchDailyAllowancesSelector } from \"./data/selectordata\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport CheckIcon from \"@material-ui/icons/Check\";\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport ArrowBackIcon from \"@material-ui/icons/ArrowBack\";\r\nimport { CustomDialog } from \"../helpers/CustomDialog\";\r\nimport { useDailyAllowancesContext } from \"../context/dailyallowances_context\";\r\n//import { useEmployeesContext } from \"../context/employees_context\";\r\nimport DailyAllowsDetlsTable from \"./DailyAllowsDetlsTable\";\r\n\r\nconst FILTERSTRING = \"Pending\";\r\n\r\nconst columns = [\r\n  {\r\n    title: \"Name\",\r\n    field: \"name\",\r\n    editable: \"never\",\r\n  },\r\n  { title: \"Period\", field: \"period\", editable: \"never\" },\r\n  { title: \"Location\", field: \"location\", editable: \"never\" },\r\n  { title: \"Manager Name\", field: \"manager\", editable: \"never\" },\r\n  {\r\n    title: \"No Of Days\",\r\n    field: \"no_of_days\",\r\n    type: \"numeric\",\r\n    editable: \"never\",\r\n  },\r\n  { title: \"Amount\", field: \"amount\", type: \"currency\", editable: \"never\" },\r\n  {\r\n    title: \"Status\",\r\n    field: \"status\",\r\n    editComponent: (props) => (\r\n      <TextField\r\n        //defaultValue={props.value || null}\r\n        onChange={(e) => props.onChange(e.target.value)}\r\n        style={{ width: 100 }}\r\n        value={props.value}\r\n        select\r\n      >\r\n        <MenuItem value=\"Pending\">Pending</MenuItem>\r\n        <MenuItem value=\"Approve\">Approve</MenuItem>\r\n        <MenuItem value=\"Reject\">Reject</MenuItem>\r\n        <MenuItem value=\"Cancel\">Cancel</MenuItem>\r\n      </TextField>\r\n    ),\r\n  },\r\n];\r\n\r\nexport default function DailyAllowancesTable({\r\n  dailyallowancesdata,\r\n  setDailyAllowancesdata,\r\n  update_dailyallowance_error,\r\n  handleDialogClose,\r\n}) {\r\n  let history = useHistory();\r\n  const classes = useStyles();\r\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\r\n  const [tmpallowsdata, setTmpallowsdata] = useState([]);\r\n  const allows_period = useRecoilValue(allowsPeriodState);\r\n  const allows_empid = useRecoilValue(empidState);\r\n  const [allowsdata, setAllowsdata] = useRecoilState(allowsDataState);\r\n  const setEmpID = useSetRecoilState(empidState);\r\n  const title = `Site Allowances (${allows_period})`;\r\n  const {\r\n    dailyallowances_loading,\r\n    singlebatch_dailyallowance,\r\n    singlebatch_dailyallowance_loading,\r\n    deleteDailyAllowance,\r\n    updateDailyAllowance,\r\n    setEditDailyAllowanceID,\r\n    setIsDailyAllowanceEditingOn,\r\n    setIsDailyAllowanceEditingOff,\r\n    resetSingleDailyAllowance,\r\n    dailyallowance_period,\r\n    getSingleBatchDailyAllowance,\r\n  } = useDailyAllowancesContext();\r\n\r\n  const Save_DailyAllowancesData = () => {\r\n    dailyallowancesdata.forEach((data) => {\r\n      const { id } = data;\r\n      if (id) {\r\n        const { id, rec_id, tableData, ...fields } = data;\r\n        updateDailyAllowance({ id, ...fields });\r\n      }\r\n    });\r\n\r\n    handleDialogClose();\r\n  };\r\n\r\n  const Approve_DailyAllowancesData = () => {\r\n    dailyallowancesdata.forEach((rec) => {\r\n      if (rec.tableData.checked) {\r\n        updateDailyAllowance({ id: rec.id, status: \"Approve\" });\r\n        //update leavesdata\r\n        if (!update_dailyallowance_error) {\r\n          const recdata = dailyallowancesdata.filter((r) => r.id === rec.id);\r\n          recdata[0].status = \"Approve\";\r\n        }\r\n      }\r\n    });\r\n    dailyallowancesdata.forEach((d) => {\r\n      if (d.tableData) d.tableData.checked = false;\r\n    });\r\n  };\r\n\r\n  const Reject_DailyAllowancesData = () => {\r\n    dailyallowancesdata.forEach((rec) => {\r\n      if (rec.tableData.checked) {\r\n        updateDailyAllowance({ id: rec.id, status: \"Reject\" });\r\n        //update leavesdata\r\n        if (!update_dailyallowance_error) {\r\n          const recdata = dailyallowancesdata.filter((r) => r.id === rec.id);\r\n          recdata[0].status = \"Reject\";\r\n        }\r\n      }\r\n    });\r\n    dailyallowancesdata.forEach((d) => {\r\n      if (d.tableData) d.tableData.checked = false;\r\n    });\r\n  };\r\n\r\n  if (dailyallowances_loading) {\r\n    return (\r\n      <div>\r\n        <h2>Loading... daily allowances</h2>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <div style={{ maxWidth: \"100%\", paddingTop: \"5px\" }}>\r\n        <MaterialTable\r\n          columns={columns}\r\n          data={dailyallowancesdata}\r\n          title={title}\r\n          icons={{\r\n            Add: (props) => <AddIcon />,\r\n            Edit: (props) => <EditIcon />,\r\n            Delete: (props) => <DeleteIcon />,\r\n            Clear: (props) => <DeleteIcon />,\r\n            Check: (props) => <CheckIcon />,\r\n            Search: (props) => <SearchIcon />,\r\n            ResetSearch: (props) => <DeleteIcon />,\r\n          }}\r\n          // editable={{\r\n          //   onRowUpdate: (newData, oldData) =>\r\n          //     new Promise((resolve, reject) => {\r\n          //       setTimeout(() => {\r\n          //         const dataUpdate = [...dailyallowancesdata];\r\n          //         const index = oldData.tableData.id;\r\n          //         dataUpdate[index] = newData;\r\n          //         setDailyAllowancesdata([...dataUpdate]);\r\n          //         //approve_Expense(newData);\r\n\r\n          //         resolve();\r\n          //       }, 1000);\r\n          //     }),\r\n          // }}\r\n          options={{\r\n            filtering: true,\r\n            selection: true,\r\n            headerStyle: {\r\n              backgroundColor: \"orange\",\r\n              color: \"#FFF\",\r\n            },\r\n            showTitle: true,\r\n          }}\r\n          components={{\r\n            Toolbar: (props) => (\r\n              <div>\r\n                <MTableToolbar {...props} />\r\n                <div style={{ padding: \"5px 10px\" }}>\r\n                  <Button\r\n                    type=\"submit\"\r\n                    variant=\"contained\"\r\n                    color=\"secondary\"\r\n                    className={classes.button}\r\n                    onClick={Approve_DailyAllowancesData}\r\n                  >\r\n                    Approve\r\n                  </Button>\r\n                  <Button\r\n                    type=\"submit\"\r\n                    variant=\"contained\"\r\n                    color=\"secondary\"\r\n                    className={classes.button}\r\n                    onClick={Reject_DailyAllowancesData}\r\n                  >\r\n                    Reject\r\n                  </Button>\r\n                  {/* <Button\r\n                    type=\"submit\"\r\n                    variant=\"contained\"\r\n                    color=\"secondary\"\r\n                    className={classes.button}\r\n                    onClick={Save_DailyAllowancesData}\r\n                  >\r\n                    Update <Icon className={classes.rightIcon}>send</Icon>\r\n                  </Button> */}\r\n                </div>\r\n              </div>\r\n            ),\r\n          }}\r\n        />\r\n        <div className={classes.dialog}>\r\n          <CustomDialog\r\n            isOpen={isDialogOpen}\r\n            handleClose={handleDialogClose}\r\n            title=\"\"\r\n            showButton={true}\r\n            isFullscreen={true}\r\n            isFullwidth={true}\r\n          >\r\n            <DailyAllowsDetlsTable\r\n              setAllowsdata={setAllowsdata}\r\n              allowsdata={allowsdata}\r\n              handleDialogClose={handleDialogClose}\r\n            />\r\n          </CustomDialog>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    padding: 0,\r\n  },\r\n  button: {\r\n    margin: theme.spacing(1),\r\n  },\r\n  dialog: {\r\n    width: 1000,\r\n  },\r\n}));\r\n"]},"metadata":{},"sourceType":"module"}