{"ast":null,"code":"import _regeneratorRuntime from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"D:/react-myprojects/hrms-airtable-july2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import React,{useState,useEffect}from\"react\";import MaterialTable from\"material-table\";import{makeStyles}from\"@material-ui/core/styles\";import{useSetRecoilState,useRecoilValue}from\"recoil\";import{payPeriodState,payPeriodEndMonthState,payPeriodEmpIdState}from\"./data/atomdata\";import{usePayslipsContext}from\"../context/payslips_context\";import{useTablesContext}from\"../context/tables_context\";import{jsx as _jsx}from\"react/jsx-runtime\";export default function Payslip_ViewDeductions(){var classes=useStyles();var payPeriodEmpId=useRecoilValue(payPeriodEmpIdState);var payPeriod=useRecoilValue(payPeriodState);var _usePayslipsContext=usePayslipsContext(),payslipdeductions=_usePayslipsContext.payslipdeductions,payslip_deduction_amount=_usePayslipsContext.payslip_deduction_amount,setPayslipDeductionAmount=_usePayslipsContext.setPayslipDeductionAmount,loadPayslipDeductions=_usePayslipsContext.loadPayslipDeductions,addPayslipDeduction=_usePayslipsContext.addPayslipDeduction,payslipdeductions_loading=_usePayslipsContext.payslipdeductions_loading,updatePayslipDeduction=_usePayslipsContext.updatePayslipDeduction,deletePayslipDeduction=_usePayslipsContext.deletePayslipDeduction,updatePayslip=_usePayslipsContext.updatePayslip,editPayslipID=_usePayslipsContext.editPayslipID,single_payslip=_usePayslipsContext.single_payslip,payslip_period=_usePayslipsContext.payslip_period,getSingleBatchPayslipDeductions=_usePayslipsContext.getSingleBatchPayslipDeductions;var name=payslipdeductions.name,amount=payslipdeductions.amount;var _useTablesContext=useTablesContext(),deductions=_useTablesContext.deductions;var calc_Deduction=function calc_Deduction(data){var sum=data.reduce(function(a,v){return a=a+v.amount;},0);setPayslipDeductionAmount(sum);};var columns=[{title:\"Name\",field:\"description\"},{title:\"Amount\",field:\"amount\",type:\"currency\"}];useEffect(function(){getSingleBatchPayslipDeductions(payPeriodEmpId,payPeriod);},[]);var update_Payslip=function update_Payslip(){var rec_id=single_payslip.rec_id,id=single_payslip.id,total_deductions=single_payslip.total_deductions,paydata=_objectWithoutProperties(single_payslip,[\"rec_id\",\"id\",\"total_deductions\"]);updatePayslip(_objectSpread({id:editPayslipID,total_deductions:payslip_deduction_amount},paydata));};var update_PayslipDeduction=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var id,rec_id,empid,fields;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:id=data.id,rec_id=data.rec_id,empid=data.empid,fields=_objectWithoutProperties(data,[\"id\",\"rec_id\",\"empid\"]);updatePayslipDeduction(_objectSpread({id:data.id,empid:empid},fields));update_Payslip();getSingleBatchPayslipDeductions(single_payslip.empid,payslip_period);case 4:case\"end\":return _context.stop();}}},_callee);}));return function update_PayslipDeduction(_x){return _ref.apply(this,arguments);};}();var add_PayslipDeduction=function add_PayslipDeduction(data){var description=data.description,amount=data.amount;addPayslipDeduction({description:description,amount:amount,name:single_payslip.name,empid:single_payslip.empid,period:single_payslip.period});getSingleBatchPayslipDeductions(single_payslip.empid,payslip_period);};var delete_PayslipDeduction=function delete_PayslipDeduction(data){var id=data.id;deletePayslipDeduction(id);getSingleBatchPayslipDeductions(single_payslip.empid,payslip_period);};if(payslipdeductions_loading){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Loading... Expenses.\"})});}return/*#__PURE__*/_jsx(\"div\",{className:classes.root,children:/*#__PURE__*/_jsx(\"div\",{style:{maxWidth:\"100%\",paddingTop:\"5px\"},children:/*#__PURE__*/_jsx(MaterialTable,{columns:columns,data:payslipdeductions,title:\"Expense\",options:{search:false,toolbar:false}})})});}var useStyles=makeStyles(function(theme){return{root:{padding:0}};});","map":{"version":3,"sources":["D:/react-myprojects/hrms-airtable-july2/src/components/Payslip_ViewDeductions.js"],"names":["React","useState","useEffect","MaterialTable","makeStyles","useSetRecoilState","useRecoilValue","payPeriodState","payPeriodEndMonthState","payPeriodEmpIdState","usePayslipsContext","useTablesContext","Payslip_ViewDeductions","classes","useStyles","payPeriodEmpId","payPeriod","payslipdeductions","payslip_deduction_amount","setPayslipDeductionAmount","loadPayslipDeductions","addPayslipDeduction","payslipdeductions_loading","updatePayslipDeduction","deletePayslipDeduction","updatePayslip","editPayslipID","single_payslip","payslip_period","getSingleBatchPayslipDeductions","name","amount","deductions","calc_Deduction","data","sum","reduce","a","v","columns","title","field","type","update_Payslip","rec_id","id","total_deductions","paydata","update_PayslipDeduction","empid","fields","add_PayslipDeduction","description","period","delete_PayslipDeduction","root","maxWidth","paddingTop","search","toolbar","theme","padding"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\n\r\nimport MaterialTable from \"material-table\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { useSetRecoilState, useRecoilValue } from \"recoil\";\r\nimport {\r\n  payPeriodState,\r\n  payPeriodEndMonthState,\r\n  payPeriodEmpIdState,\r\n} from \"./data/atomdata\";\r\nimport { usePayslipsContext } from \"../context/payslips_context\";\r\nimport { useTablesContext } from \"../context/tables_context\";\r\n\r\nexport default function Payslip_ViewDeductions() {\r\n  const classes = useStyles();\r\n  const payPeriodEmpId = useRecoilValue(payPeriodEmpIdState);\r\n  const payPeriod = useRecoilValue(payPeriodState);\r\n  \r\n  const {\r\n    payslipdeductions,\r\n    payslip_deduction_amount,\r\n    setPayslipDeductionAmount,\r\n    loadPayslipDeductions,\r\n    addPayslipDeduction,\r\n    payslipdeductions_loading,\r\n    updatePayslipDeduction,\r\n    deletePayslipDeduction,\r\n    updatePayslip,\r\n    editPayslipID,\r\n    single_payslip,\r\n    payslip_period,\r\n    getSingleBatchPayslipDeductions,\r\n  } = usePayslipsContext();\r\n  const { name, amount } = payslipdeductions;\r\n  const { deductions } = useTablesContext();\r\n\r\n  const calc_Deduction = (data) => {\r\n    const sum = data.reduce((a, v) => (a = a + v.amount), 0);\r\n    setPayslipDeductionAmount(sum);\r\n  };\r\n\r\n  const columns = [\r\n    {\r\n      title: \"Name\",\r\n      field: \"description\",\r\n    },\r\n    { title: \"Amount\", field: \"amount\", type: \"currency\" },\r\n  ];\r\n\r\n  useEffect(() => {\r\n    getSingleBatchPayslipDeductions(payPeriodEmpId, payPeriod);\r\n  }, []);\r\n\r\n  \r\n  const update_Payslip = () => {\r\n    const { rec_id, id, total_deductions, ...paydata } = single_payslip;\r\n    updatePayslip({\r\n      id: editPayslipID,\r\n      total_deductions: payslip_deduction_amount,\r\n      ...paydata,\r\n    });\r\n  };\r\n\r\n  const update_PayslipDeduction = async (data) => {\r\n    const { id, rec_id, empid, ...fields } = data;\r\n    updatePayslipDeduction({ id: data.id, empid: empid, ...fields });\r\n    update_Payslip();\r\n    getSingleBatchPayslipDeductions(single_payslip.empid, payslip_period);\r\n  };\r\n\r\n  const add_PayslipDeduction = (data) => {\r\n    const { description, amount } = data;\r\n    addPayslipDeduction({\r\n      description: description,\r\n      amount: amount,\r\n      name: single_payslip.name,\r\n      empid: single_payslip.empid,\r\n      period: single_payslip.period,\r\n    });\r\n    getSingleBatchPayslipDeductions(single_payslip.empid, payslip_period);\r\n  };\r\n\r\n  const delete_PayslipDeduction = (data) => {\r\n    const { id } = data;\r\n    deletePayslipDeduction(id);\r\n    getSingleBatchPayslipDeductions(single_payslip.empid, payslip_period);\r\n  };\r\n\r\n  \r\n  if (payslipdeductions_loading) {\r\n    return (\r\n      <div>\r\n        <h2>Loading... Expenses.</h2>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      {/* <h1>Expenses Claims Application</h1> */}\r\n\r\n      <div style={{ maxWidth: \"100%\", paddingTop: \"5px\" }}>\r\n        <MaterialTable\r\n          columns={columns}\r\n          data={payslipdeductions}\r\n          title=\"Expense\"\r\n          options={{\r\n            search: false,\r\n            toolbar: false,\r\n          }}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    padding: 0,\r\n  },\r\n}));\r\n"]},"metadata":{},"sourceType":"module"}